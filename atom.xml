<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>思想家</title>
  
  <subtitle>有限的时间，编写先限的可能</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://liukay.com/"/>
  <updated>2021-04-25T11:05:38.957Z</updated>
  <id>http://liukay.com/</id>
  
  <author>
    <name>咪雅先森</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>blockchain--Tron交易接收机制</title>
    <link href="http://liukay.com/2021/04/17/blockchain-Tron%E4%BA%A4%E6%98%93%E6%8E%A5%E6%94%B6%E6%9C%BA%E5%88%B6/"/>
    <id>http://liukay.com/2021/04/17/blockchain-Tron交易接收机制/</id>
    <published>2021-04-17T06:00:28.000Z</published>
    <updated>2021-04-25T11:05:38.957Z</updated>
    
    <summary type="html">
    
    </summary>
    
      <category term="blockchain" scheme="http://liukay.com/categories/blockchain/"/>
    
    
      <category term="blockchain" scheme="http://liukay.com/tags/blockchain/"/>
    
      <category term="区块链" scheme="http://liukay.com/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/"/>
    
      <category term="交易" scheme="http://liukay.com/tags/%E4%BA%A4%E6%98%93/"/>
    
  </entry>
  
  <entry>
    <title>区块链--02比特币技术体系</title>
    <link href="http://liukay.com/2021/04/17/blockchain-%E5%8C%BA%E5%9D%97%E9%93%BE-02%E6%AF%94%E7%89%B9%E5%B8%81%E6%8A%80%E6%9C%AF%E4%BD%93%E7%B3%BB/"/>
    <id>http://liukay.com/2021/04/17/blockchain-区块链-02比特币技术体系/</id>
    <published>2021-04-17T03:53:03.000Z</published>
    <updated>2021-04-27T14:30:06.003Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>学习区块链技术，首先应该了解最经典的 比特币。比特币做为最早的分布式去中心化的区块链应用，其经典设计值得学习。</p></blockquote><h2 id="比特币架构"><a href="#比特币架构" class="headerlink" title="比特币架构"></a>比特币架构</h2><p>比特币通过将各项技术进行结合，创造出来的这个产品，其本质的功能是记账，副做用是炒。<br>比特币的设计是为了保证所有数据是分布式的、去中心化的保存数据，防止数据在中心的节点中保存。</p><p><img src="/2021/04/17/blockchain-%E5%8C%BA%E5%9D%97%E9%93%BE-02%E6%AF%94%E7%89%B9%E5%B8%81%E6%8A%80%E6%9C%AF%E4%BD%93%E7%B3%BB/BTC架构图.jpeg" alt="架构图"></p><p>自上而下，共分6层</p><ol><li>应用层</li><li>RPC 层</li><li>网络层</li><li>共识层</li><li>数据层</li><li>存储层</li></ol><h3 id="1-应用层"><a href="#1-应用层" class="headerlink" title="1.应用层"></a>1.应用层</h3><p>包括比特币钱包、客户端等种上层的应用，一般是比特币程序本身的外部应用。<br>以比特币钱包为例，比特币钱包有很多种，可以上官网上下载不同钱包，比如最简单的钱包，早期这个钱包还保留有CPU挖矿功能。现在版本已不支持，可以参考官方 Github 文档:</p><p><a href="https://github.com/bitcoin/bitcoin/blob/master/doc/release-notes/release-notes-0.13.0.md">https://github.com/bitcoin/bitcoin/blob/master/doc/release-notes/release-notes-0.13.0.md</a><br><img src="/2021/04/17/blockchain-%E5%8C%BA%E5%9D%97%E9%93%BE-02%E6%AF%94%E7%89%B9%E5%B8%81%E6%8A%80%E6%9C%AF%E4%BD%93%E7%B3%BB/BTC钱包.jpg" alt="PC钱包"></p><h3 id="2-RPC-层"><a href="#2-RPC-层" class="headerlink" title="2.RPC 层"></a>2.RPC 层</h3><p>RPC 层的作用是进行RPC 通信。测试可以使用 BitCore 这个工具来进行测试。</p><p>测试一个 RPC 命令，查看区块信息: <strong>getblockchaininfo</strong><br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;chain&quot;</span>: <span class="string">&quot;main&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;blocks&quot;</span>: <span class="number">680816</span>,</span><br><span class="line">  <span class="attr">&quot;headers&quot;</span>: <span class="number">680816</span>,</span><br><span class="line">  <span class="attr">&quot;bestblockhash&quot;</span>: <span class="string">&quot;0000000000000000000133b07fdf287ddca3cca80162b4a06a05d6904190cd37&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;difficulty&quot;</span>: <span class="number">23581981443663.85</span>,</span><br><span class="line">  <span class="attr">&quot;mediantime&quot;</span>: <span class="number">1619518237</span>,</span><br><span class="line">  <span class="attr">&quot;verificationprogress&quot;</span>: <span class="number">0.999995596389184</span>,</span><br><span class="line">  <span class="attr">&quot;initialblockdownload&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">&quot;chainwork&quot;</span>: <span class="string">&quot;00000000000000000000000000000000000000001c943902d1cf6cdd1387c75c&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;size_on_disk&quot;</span>: <span class="number">1904190175</span>,</span><br><span class="line">  <span class="attr">&quot;pruned&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">&quot;pruneheight&quot;</span>: <span class="number">679647</span>,</span><br><span class="line">  <span class="attr">&quot;automatic_pruning&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">&quot;prune_target_size&quot;</span>: <span class="number">1999634432</span>,</span><br><span class="line">  <span class="attr">&quot;softforks&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;bip34&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;buried&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;active&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">&quot;height&quot;</span>: <span class="number">227931</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;bip66&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;buried&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;active&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">&quot;height&quot;</span>: <span class="number">363725</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;bip65&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;buried&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;active&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">&quot;height&quot;</span>: <span class="number">388381</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;csv&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;buried&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;active&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">&quot;height&quot;</span>: <span class="number">419328</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;segwit&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;buried&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;active&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">&quot;height&quot;</span>: <span class="number">481824</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;warnings&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="3-网络层"><a href="#3-网络层" class="headerlink" title="3.网络层"></a>3.网络层</h3><p>网络层使用 Peer-to-Peer，即点对点通信。每个BTC网络当中的节点中的通信，没有中心化的节点进行转发，需要通过节点发现，进行通信。<br>这也体现出BTC网络中当，每个节点都是平等的节点，没有哪个节点可以控制其他节点。</p><p>这种去中心化的好处就是可以做到节点之间的平等，但是也存在几个问题。</p><ol><li>网络延迟</li><li>联合作敝</li></ol><p>3.1 网络延迟很好理解，由于节点之间是平等的，每个节点都会呈现为网状的连接，当一个区块被生产出来后，会同步到相邻的网络节点当中，进行相邻转发。并不是通过中心节点订阅或转发的，一个区块到达所有的节点会有网络延迟。</p><p>3.2 联合作敝，去中心化的通信，节点间的数据只能依赖于依赖于各个节点间的验证，那就给做敝留下了空间。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;学习区块链技术，首先应该了解最经典的 比特币。比特币做为最早的分布式去中心化的区块链应用，其经典设计值得学习。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;比特币架构&quot;&gt;&lt;a href=&quot;#比特币架构&quot; class=&quot;headerlink&quot;
      
    
    </summary>
    
      <category term="blockchain" scheme="http://liukay.com/categories/blockchain/"/>
    
      <category term="BTC" scheme="http://liukay.com/categories/blockchain/BTC/"/>
    
    
      <category term="区块链" scheme="http://liukay.com/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/"/>
    
      <category term="比特币" scheme="http://liukay.com/tags/%E6%AF%94%E7%89%B9%E5%B8%81/"/>
    
      <category term="技术体系" scheme="http://liukay.com/tags/%E6%8A%80%E6%9C%AF%E4%BD%93%E7%B3%BB/"/>
    
  </entry>
  
  <entry>
    <title>blockchain--DPOS协议</title>
    <link href="http://liukay.com/2021/04/16/blockchain-DPOS%E5%8D%8F%E8%AE%AE/"/>
    <id>http://liukay.com/2021/04/16/blockchain-DPOS协议/</id>
    <published>2021-04-16T07:05:43.000Z</published>
    <updated>2021-04-26T02:40:04.225Z</updated>
    
    <summary type="html">
    
    </summary>
    
      <category term="blockchain" scheme="http://liukay.com/categories/blockchain/"/>
    
    
      <category term="blockchain" scheme="http://liukay.com/tags/blockchain/"/>
    
      <category term="区块链" scheme="http://liukay.com/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/"/>
    
      <category term="DPOS协议" scheme="http://liukay.com/tags/DPOS%E5%8D%8F%E8%AE%AE/"/>
    
  </entry>
  
  <entry>
    <title>区块链--04比特币区块同步机制</title>
    <link href="http://liukay.com/2021/04/15/blockchain-%E5%8C%BA%E5%9D%97%E9%93%BE-04%E6%AF%94%E7%89%B9%E5%B8%81%E5%8C%BA%E5%9D%97%E5%90%8C%E6%AD%A5%E6%9C%BA%E5%88%B6/"/>
    <id>http://liukay.com/2021/04/15/blockchain-区块链-04比特币区块同步机制/</id>
    <published>2021-04-15T03:41:28.000Z</published>
    <updated>2021-04-27T04:11:58.666Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><blockquote><p>一个区块生产出来之后，需要进行同步给其它的节点。由于区块链是去中心化的，所以所有节点都保留相同的全量数据。<br>当一个区块打包好一个区块后，需要同步给其它节点，进行校验 和 上链。<br>只有上链的成功的区块，才算是区块链上的一个块。换句话说，区块可能上链成功，也有可能上链不成功。</p></blockquote><h2 id="同步区块中的问题"><a href="#同步区块中的问题" class="headerlink" title="同步区块中的问题"></a>同步区块中的问题</h2><ol><li>为什么要同步区块</li><li>如何保证同步</li><li>网络延迟如何解决</li><li>同时收到相同高度的块，该同步谁的块</li><li>如何得知块已被确认</li><li>被丢块的节点会怎么样</li></ol><h2 id="区块打包"><a href="#区块打包" class="headerlink" title="区块打包"></a>区块打包</h2><h2 id="区块广播"><a href="#区块广播" class="headerlink" title="区块广播"></a>区块广播</h2><h2 id="区块验证"><a href="#区块验证" class="headerlink" title="区块验证"></a>区块验证</h2><h2 id="区块上链"><a href="#区块上链" class="headerlink" title="区块上链"></a>区块上链</h2><h2 id="区块回滚"><a href="#区块回滚" class="headerlink" title="区块回滚"></a>区块回滚</h2>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;一个区块生产出来之后，需要进行同步给其它的节点。由于区块链是去中心化的，所以所有节点都保留相同的全量数据。&lt;br&gt;
      
    
    </summary>
    
      <category term="blockchain" scheme="http://liukay.com/categories/blockchain/"/>
    
      <category term="BTC" scheme="http://liukay.com/categories/blockchain/BTC/"/>
    
    
      <category term="blockchain" scheme="http://liukay.com/tags/blockchain/"/>
    
      <category term="区块链" scheme="http://liukay.com/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/"/>
    
      <category term="比特币" scheme="http://liukay.com/tags/%E6%AF%94%E7%89%B9%E5%B8%81/"/>
    
  </entry>
  
  <entry>
    <title>区块链--01区块链初识</title>
    <link href="http://liukay.com/2021/04/14/blockchain--%E5%8C%BA%E5%9D%97%E9%93%BE01-%E6%8A%80%E6%9C%AF%E6%9E%B6%E6%9E%84/"/>
    <id>http://liukay.com/2021/04/14/blockchain--区块链01-技术架构/</id>
    <published>2021-04-14T10:50:49.000Z</published>
    <updated>2021-04-27T03:49:09.321Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>区块链技术，发展到目前，主流的区块链有两个代表，一个是以 比特币(BTC) 为代表的分布式去中心化记账本，一个是以 以态坊(ETH) 为代表的图灵完备的分布式去中心化计算机。名词解释会放到下面。</p></blockquote><h2 id="为什么写这个文章"><a href="#为什么写这个文章" class="headerlink" title="为什么写这个文章"></a>为什么写这个文章</h2><p>投身加密货币研究有一段时间了，其间了解到了比特币的原理和应用，想把了解到的知识整理成一个简单直白的系列科普文章，希望可以帮助大家轻松简单学习并使用加密货币。<br>本篇作为开篇，仅提一些简单概念，以免概念太多，让人望而却步。</p><h2 id="加密货币"><a href="#加密货币" class="headerlink" title="加密货币"></a>加密货币</h2><p>加密货币当下有两种主流的技术模型：</p><ol><li>比特币</li><li>以太坊</li></ol><p>这两种加密货币有本质的区别，之所以很少听说以太坊，是因为以太坊出现的在比特币之后，出现在人们的视野里比较晚，但是其设计理念相较比特币较超前，当前和比特币并驾齐驱。<br>现在主流的一些币都是基于以太坊的基础上进行设计，还可以基于以太坊发行自己的货币，在这里不用深究，后续会深入讲解。</p><h2 id="比特币-Bitcoin"><a href="#比特币-Bitcoin" class="headerlink" title="比特币(Bitcoin)"></a>比特币(Bitcoin)</h2><blockquote><p>本质是分布式记账本</p></blockquote><p>比特币的宗旨是做为一个去中心化的分布试记账本，仅为了记账而存在。<br>比特币的由来就不赘述，可自行了解。<br>BTC是一种点对点（Peer-2-Peer）传输的数字加密货币。宗旨在于使用点网络节点，构成一个分布式、去中心化的加密货币网络。<br>机器只需要运行 BTC 程序，就可以加入到比特币网络当中，成为一个节点，每个节点同步保存全量数据，所以硬盘容量要大。</p><p><strong>官网</strong> <a href="https://bitcoin.org/zh_CN/">https://bitcoin.org/zh_CN/</a></p><h3 id="1-本质"><a href="#1-本质" class="headerlink" title="1.本质"></a>1.本质</h3><p>是一个分布式、去中心化账本！！<br>记账才是其主要功能，奖励的币仅是副产物。</p><h3 id="2-币是什么"><a href="#2-币是什么" class="headerlink" title="2.币是什么"></a>2.币是什么</h3><p>币，是每个机器运行比特币服务而获得的奖励，鼓励大家都运行节点，保存数据。就像是去玩某个游戏，每日登陆获取积分一样。<br>每个机器节点的硬盘上保留全量数据，就可以不依赖于中心化节点中的数据，从而实现去中心化。<br>每个用户下载 BTC 的钱包服务运行，注册钱包，生成私钥，私钥需要保管好。并配上自己的钱包地址。</p><h3 id="3-如何获得一个比特币"><a href="#3-如何获得一个比特币" class="headerlink" title="3.如何获得一个比特币"></a>3.如何获得一个比特币</h3><p>谁打包谁获得比特币奖励。<br>比特币的将励不是公平的，而是一有套获取奖励的规则，并不是运行的久的节点一定获得奖励。而在于你的计算机的算力。<br>比特币规定，所有记账节点都有资格打包，但是需要算出一道数学题，谁先算出来，谁就有资格打包，打包的节点就会获得奖励。<br>这种模式即：<strong>POW 工作量证明</strong></p><h3 id="4-比特币白皮书"><a href="#4-比特币白皮书" class="headerlink" title="4.比特币白皮书"></a>4.比特币白皮书</h3><p><a href="https://bitcoin.org/bitcoin.pdf">比特币白皮书原版</a><br>当然还有中文版。</p><h3 id="比特币泛汲到的技术"><a href="#比特币泛汲到的技术" class="headerlink" title="比特币泛汲到的技术"></a>比特币泛汲到的技术</h3><p><strong>结构图</strong><br><img src="/2021/04/14/blockchain--%E5%8C%BA%E5%9D%97%E9%93%BE01-%E6%8A%80%E6%9C%AF%E6%9E%B6%E6%9E%84/BTC.jpeg" alt="结构图"><br>比特币并没有发明什么新技术，而是将已有的技术进行一个融合。</p><ol><li>加密技术</li><li>P2P 通信(点对点)</li><li>共识</li><li>存储</li></ol><h3 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h3><h2 id="以太坊"><a href="#以太坊" class="headerlink" title="以太坊"></a>以太坊</h2><blockquote><p>区块链世界中的计算机。</p></blockquote><p>如果说 比特币 是一个分布式、去中心化账本，那以太坊就是一台分布式去中心化，运行在计算机上的微型计算机。<br>其设计架构就是图灵完备的设计，本质是一套程序，但是它有计算机一样的：输入、输出、执行指令，因此可以说是图灵完备的。</p><h3 id="以太坊架构图"><a href="#以太坊架构图" class="headerlink" title="以太坊架构图"></a>以太坊架构图</h3><p><img src="/2021/04/14/blockchain--%E5%8C%BA%E5%9D%97%E9%93%BE01-%E6%8A%80%E6%9C%AF%E6%9E%B6%E6%9E%84/架构图.png" alt="架构图"></p><h3 id="系统结构"><a href="#系统结构" class="headerlink" title="系统结构"></a>系统结构</h3><ol><li>智能合约</li><li>加密技术</li><li>P2P 通信(点对点)</li><li>共识</li><li>存储</li></ol><h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><p>以太坊在设计上和比特币目的相同，但是在很多设计上又有很多的不同。</p><h4 id="1-可编程"><a href="#1-可编程" class="headerlink" title="1.可编程"></a>1.可编程</h4><p>以太坊的最大特点就是，它是一个<strong>可编程</strong>的区块链。<br>每个用户可自行编写自己业务逻辑代码，通过接口去触发自己编写的代码，这种代码官方叫做智能合约。<br>通过智能合约(编程代码)，用户可以实现很多功能，比如：分布式去中心化应用(DAPP)、分布式去中心化金融(DeFi) 等。<br>DAPP 包括一些游戏，目前国内 DAPP 数量较多的是波场(Tron)的 DAPP。</p><p>实现这些功能是因为设计了编程语言 Solidity 和 虚拟机EVM</p><p>和BTC 一样也是基于 POW 的区块链。但是 ETH2.0 正在转向 POS。什么是 POS 后面再说。</p><h4 id="2-账户模型"><a href="#2-账户模型" class="headerlink" title="2.账户模型"></a>2.账户模型</h4><p>以太坊的账户模型是基于账户系统，另外还有一个世界状态。这个世界状态也是有利有憋。</p><h4 id="3-奖励机制"><a href="#3-奖励机制" class="headerlink" title="3.奖励机制"></a>3.奖励机制</h4><p>这个和比特币不同，比特币只有产块的节点能获得比特币。以太坊采用叔块（Uncle Block）激励机制，即你产了这个块，但是最后确认不是你所产的这个块，未被确认的这个块叫(Uncle Block),也给你一定的奖励。</p><h4 id="4-燃汽-Gas"><a href="#4-燃汽-Gas" class="headerlink" title="4.燃汽 Gas"></a>4.燃汽 Gas</h4><p>以太坊还引入了 燃汽 Gas 的概念，转账需要消耗 Gas，就这让使用 ETH 币进行转账就需要成本。这个有利也有憋。<br>有了 Gas 之后，对于矿工来说，矿工们就可以选择将转账支付 Gas 较高的订单优先进行上链，矿工们收益好。但是对于用户来说，如果支付的低的话，那就要等上一些时间。<br>这样就造成拥堵。<br>Gas 还有个作用，控制每一次执行合约的消耗，即 GasLimit，看不明白的不用深究，后续都会深入说明。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>当下区块链世界各种生态都在雨后春笋一般的建设中，BTC 是当之无愧的价值体现，以太坊也在奋起直追。币圈的运做也可以看做另一个世界的金融运做，币本身构建自己的生态，金融圈大庄操作币价。两相结合，推动币值，一边割韭菜，一边做技术。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;区块链技术，发展到目前，主流的区块链有两个代表，一个是以 比特币(BTC) 为代表的分布式去中心化记账本，一个是以 以态坊(ETH) 为代表的图灵完备的分布式去中心化计算机。名词解释会放到下面。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;
      
    
    </summary>
    
      <category term="blockchain" scheme="http://liukay.com/categories/blockchain/"/>
    
    
      <category term="架构" scheme="http://liukay.com/tags/%E6%9E%B6%E6%9E%84/"/>
    
      <category term="blockchain" scheme="http://liukay.com/tags/blockchain/"/>
    
      <category term="区块链" scheme="http://liukay.com/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/"/>
    
  </entry>
  
  <entry>
    <title>blockchain--区块链文章大纲</title>
    <link href="http://liukay.com/2021/04/11/blockchain-%E5%8C%BA%E5%9D%97%E9%93%BE%E6%96%87%E7%AB%A0%E5%A4%A7%E7%BA%B2/"/>
    <id>http://liukay.com/2021/04/11/blockchain-区块链文章大纲/</id>
    <published>2021-04-11T03:43:03.000Z</published>
    <updated>2021-04-25T11:01:03.338Z</updated>
    
    <content type="html"><![CDATA[<p>现在从业区块链行业的架构研发，记录对区块链的理解，创建一个文章目录，将需要理解的东西一一记录下来。</p><h1 id="区块链文章大纲"><a href="#区块链文章大纲" class="headerlink" title="区块链文章大纲"></a>区块链文章大纲</h1><h2 id="区块链架构"><a href="#区块链架构" class="headerlink" title="区块链架构"></a>区块链架构</h2><h2 id="快速使用体验"><a href="#快速使用体验" class="headerlink" title="快速使用体验"></a>快速使用体验</h2><ul><li>钱包</li><li>交易<h2 id="如何交易"><a href="#如何交易" class="headerlink" title="如何交易"></a>如何交易</h2></li></ul><h2 id="成为矿工"><a href="#成为矿工" class="headerlink" title="成为矿工"></a>成为矿工</h2><h2 id="区块链共识"><a href="#区块链共识" class="headerlink" title="区块链共识"></a>区块链共识</h2><h2 id="区块链存储"><a href="#区块链存储" class="headerlink" title="区块链存储"></a>区块链存储</h2><h2 id="区块链网络"><a href="#区块链网络" class="headerlink" title="区块链网络"></a>区块链网络</h2><h2 id="区块链加密"><a href="#区块链加密" class="headerlink" title="区块链加密"></a>区块链加密</h2><h2 id="跨链"><a href="#跨链" class="headerlink" title="跨链"></a>跨链</h2><h2 id="预言机"><a href="#预言机" class="headerlink" title="预言机"></a>预言机</h2>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;现在从业区块链行业的架构研发，记录对区块链的理解，创建一个文章目录，将需要理解的东西一一记录下来。&lt;/p&gt;
&lt;h1 id=&quot;区块链文章大纲&quot;&gt;&lt;a href=&quot;#区块链文章大纲&quot; class=&quot;headerlink&quot; title=&quot;区块链文章大纲&quot;&gt;&lt;/a&gt;区块链文章大纲&lt;
      
    
    </summary>
    
      <category term="blockchain" scheme="http://liukay.com/categories/blockchain/"/>
    
    
      <category term="blockchain" scheme="http://liukay.com/tags/blockchain/"/>
    
      <category term="区块链" scheme="http://liukay.com/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/"/>
    
  </entry>
  
  <entry>
    <title>vim01-环境配置</title>
    <link href="http://liukay.com/2020/12/17/linux-vim01-%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"/>
    <id>http://liukay.com/2020/12/17/linux-vim01-环境配置/</id>
    <published>2020-12-17T04:39:17.000Z</published>
    <updated>2020-12-17T05:32:00.001Z</updated>
    
    <content type="html"><![CDATA[<p>现在开发、写文章基本上已经离不开 vim了，写代码idea + vim 配合，写文章就是直接上 vim。vim 有一定的学习曲线，但是习惯了就好。<br>习惯以后，再使用这些插件就会更好用。</p><h2 id="配置存放仓库"><a href="#配置存放仓库" class="headerlink" title="配置存放仓库:"></a>配置存放仓库:</h2><p><a href="https://github.com/forfreeday/vim">https://github.com/forfreeday/vim</a></p><h2 id="coc-java-问题"><a href="#coc-java-问题" class="headerlink" title="coc java 问题"></a>coc java 问题</h2><p>JDK 版本要高于1.8否则，JDT会启动失败。<br><a id="more"></a></p><h2 id="先上效果图"><a href="#先上效果图" class="headerlink" title="先上效果图"></a>先上效果图</h2><p><img src="/2020/12/17/linux-vim01-%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/1.jpg" alt="效果图"></p><h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm install -g neovim</span><br><span class="line">pip3 install pylint</span><br><span class="line">npm install -g typescript</span><br><span class="line">pip3 install jedi</span><br></pre></td></tr></table></figure><h2 id="Plug-插件"><a href="#Plug-插件" class="headerlink" title="Plug 插件"></a>Plug 插件</h2><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -fLo ~/.config/nvim/autoload/plug.vim --create-dirs  https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim</span><br></pre></td></tr></table></figure><h2 id="coc-settings-json"><a href="#coc-settings-json" class="headerlink" title="coc-settings.json"></a>coc-settings.json</h2><p>特别说明，要使有 coc 的java语法提示，必须指定jdk为 JDK11，否则报错<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;suggest.noselect&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">&quot;suggest.enablePreselect&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">&quot;codeLens.enable&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">&quot;java.home&quot;</span>: <span class="string">&quot;/Library/Java/JavaVirtualMachines/jdk-11.0.9.jdk/Contents/Home&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;suggest.completionItemKindLabels&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;class&quot;</span>: <span class="string">&quot;\uf0e8&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;color&quot;</span>: <span class="string">&quot;\ue22b&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;constant&quot;</span>: <span class="string">&quot;\uf8fe&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;default&quot;</span>: <span class="string">&quot;\uf29c&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;enum&quot;</span>: <span class="string">&quot;\uf435&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;enumMember&quot;</span>: <span class="string">&quot;\uf02b&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;event&quot;</span>: <span class="string">&quot;\ufacd&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;field&quot;</span>: <span class="string">&quot;\uf93d&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;file&quot;</span>: <span class="string">&quot;\uf723&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;folder&quot;</span>: <span class="string">&quot;\uf115&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;function&quot;</span>: <span class="string">&quot;\u0192&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;interface&quot;</span>: <span class="string">&quot;\uf417&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;keyword&quot;</span>: <span class="string">&quot;\uf1de&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;method&quot;</span>: <span class="string">&quot;\uf6a6&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;module&quot;</span>: <span class="string">&quot;\uf40d&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;operator&quot;</span>: <span class="string">&quot;\uf915&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;property&quot;</span>: <span class="string">&quot;\ue624&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;reference&quot;</span>: <span class="string">&quot;\ufa46&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;snippet&quot;</span>: <span class="string">&quot;\ue60b&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;struct&quot;</span>: <span class="string">&quot;\ufb44&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;text&quot;</span>: <span class="string">&quot;\ue612&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;typeParameter&quot;</span>: <span class="string">&quot;\uf728&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;unit&quot;</span>: <span class="string">&quot;\uf475&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;value&quot;</span>: <span class="string">&quot;\uf89f&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;variable&quot;</span>: <span class="string">&quot;\ue71b&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;coc.preferences.formatOnSaveFiletypes&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;json&quot;</span>,</span><br><span class="line">        <span class="string">&quot;java&quot;</span>,</span><br><span class="line">        <span class="string">&quot;python&quot;</span>,</span><br><span class="line">        <span class="string">&quot;css&quot;</span>,</span><br><span class="line">        <span class="string">&quot;dart&quot;</span>,</span><br><span class="line">        <span class="string">&quot;html&quot;</span>,</span><br><span class="line">        <span class="string">&quot;javascript&quot;</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="字体-和-iTerm2-配置"><a href="#字体-和-iTerm2-配置" class="headerlink" title="字体 和 iTerm2 配置"></a>字体 和 iTerm2 配置</h2><p>将 powerline 的字体也放到项目当中，方便大家直接导入字体。解决 <strong>vim-airline</strong> 下符号显示导常，箭头标志大小异常的问题</p><h3 id="1-字体"><a href="#1-字体" class="headerlink" title="1.字体"></a>1.字体</h3><p>直接在项目中双点安装或自行下载安装<br><figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/supermarin/powerline-fonts.git</span><br></pre></td></tr></table></figure></p><h3 id="2-iTerm2-设置"><a href="#2-iTerm2-设置" class="headerlink" title="2.iTerm2 设置"></a>2.iTerm2 设置</h3><p>安装 powerline 字体后在配置<br>安装 Menlo Regular for Powerline.otf 这个字体，在 iTerm2下显示为 <strong>Menlo for Powerline</strong>，的字体</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&quot;=================================</span></span><br><span class="line"><span class="comment">&quot; VIM 自身配置</span></span><br><span class="line"><span class="comment">&quot;=================================</span></span><br><span class="line"><span class="comment">&quot; 编码设置</span></span><br><span class="line"><span class="keyword">set</span> fileencodings=utf-<span class="number">8</span>,gb2312,gb18030,gbk,ucs-bom,cp936,latin1</span><br><span class="line"><span class="keyword">set</span> enc=utf8</span><br><span class="line"><span class="keyword">set</span> fencs=utf8,gbk,gb2312,gb18030</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; 启用插件</span></span><br><span class="line"><span class="keyword">set</span> nocompatible</span><br><span class="line"><span class="keyword">filetype</span> <span class="keyword">on</span></span><br><span class="line"><span class="keyword">filetype</span> plugin <span class="built_in">indent</span> <span class="keyword">on</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Tab 转空格</span></span><br><span class="line"><span class="keyword">set</span> tabstop=<span class="number">4</span></span><br><span class="line"><span class="keyword">set</span> <span class="built_in">shiftwidth</span>=<span class="number">4</span></span><br><span class="line"><span class="keyword">set</span> softtabstop=<span class="number">4</span></span><br><span class="line"><span class="keyword">set</span> expandtab</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; 列高亮</span></span><br><span class="line"><span class="keyword">set</span> cursorcolumn</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; 记录上次光标位置</span></span><br><span class="line"><span class="keyword">au</span> BufReadPost * <span class="keyword">if</span> <span class="built_in">line</span>(<span class="string">&quot;&#x27;\&quot;&quot;</span>) &gt; <span class="number">1</span> &amp;&amp; <span class="built_in">line</span>(<span class="string">&quot;&#x27;\&quot;&quot;</span>) &lt;= <span class="built_in">line</span>(<span class="string">&quot;$&quot;</span>) | <span class="keyword">exe</span> <span class="string">&quot;normal! g&#x27;\&quot;&quot;</span> | <span class="keyword">endif</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; 分屏设置</span></span><br><span class="line"><span class="comment">&quot; 向右分屏并把光标移动向右边</span></span><br><span class="line"><span class="keyword">map</span> td :<span class="keyword">set</span> splitright<span class="symbol">&lt;CR&gt;</span>:<span class="keyword">vsplit</span><span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="comment">&quot; 向右分屏并把光标移动向左边</span></span><br><span class="line"><span class="keyword">map</span> <span class="keyword">ta</span> :<span class="keyword">set</span> nosplitright<span class="symbol">&lt;CR&gt;</span>:<span class="keyword">vsplit</span><span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="comment">&quot; 向下分屏并把光标移动向上边</span></span><br><span class="line"><span class="keyword">map</span> <span class="keyword">ts</span> :<span class="keyword">set</span> nosplitbelow<span class="symbol">&lt;CR&gt;</span>:<span class="keyword">split</span><span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="comment">&quot; 向下分屏并把光标移动向下边</span></span><br><span class="line"><span class="keyword">map</span> tw :<span class="keyword">set</span> splitbelow<span class="symbol">&lt;CR&gt;</span>:<span class="keyword">split</span><span class="symbol">&lt;CR&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; 替换方向键为调节分屏大小</span></span><br><span class="line"><span class="keyword">map</span> <span class="symbol">&lt;up&gt;</span> :<span class="keyword">res</span> +<span class="number">5</span><span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="keyword">map</span> <span class="symbol">&lt;down&gt;</span> :<span class="keyword">res</span> -<span class="number">5</span><span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="keyword">map</span> <span class="symbol">&lt;left&gt;</span> :<span class="keyword">vertical</span> <span class="keyword">resize</span>-<span class="number">5</span><span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="keyword">map</span> <span class="symbol">&lt;right&gt;</span> :<span class="keyword">vertical</span> <span class="keyword">resize</span>+<span class="number">5</span><span class="symbol">&lt;CR&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; 按键映射</span></span><br><span class="line"><span class="keyword">map</span> W :<span class="keyword">w</span><span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="keyword">map</span> Q :<span class="keyword">wq</span><span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="keyword">map</span> tq :q!<span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="keyword">map</span> <span class="keyword">te</span> :terminal<span class="symbol">&lt;CR&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; 设置 buff、空白字符的视觉提示</span></span><br><span class="line"><span class="keyword">set</span> <span class="keyword">list</span> listchars=<span class="built_in">extend</span><span class="variable">s:</span>❯,precede<span class="variable">s:</span>❮,<span class="keyword">ta</span><span class="variable">b:</span>▸\ ,trai<span class="variable">l:</span>˽</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; 其他的一些配置</span></span><br><span class="line"><span class="keyword">syntax</span> <span class="keyword">on</span>   <span class="comment">&quot; 语法高亮</span></span><br><span class="line"><span class="keyword">set</span> <span class="keyword">number</span>      <span class="comment">&quot; 显示行号</span></span><br><span class="line"><span class="string">&quot;set relativenumber    &quot;</span> 相对行号</span><br><span class="line"><span class="keyword">set</span> wildmenu    <span class="comment">&quot;  让vim命令可用Tab补全</span></span><br><span class="line"><span class="keyword">set</span> hlsearch      <span class="comment">&quot; 变输入搜索词边高亮</span></span><br><span class="line"><span class="keyword">set</span> incsearch      <span class="comment">&quot; 光标自动跳转到搜索结果上</span></span><br><span class="line"><span class="keyword">set</span> t_ut=  <span class="comment">&quot;防止vim背景颜色错误</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot;======================================</span></span><br><span class="line"><span class="comment">&quot; VIM 自带颜色配置</span></span><br><span class="line"><span class="comment">&quot;======================================</span></span><br><span class="line"><span class="comment">&quot;光标选中部分的底色</span></span><br><span class="line"><span class="keyword">hi</span> Visual  guibg=#<span class="number">99</span>cc99  guifg=#<span class="number">334433</span> <span class="keyword">gui</span>=none ctermbg=<span class="number">9</span> ctermfg=<span class="number">15</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot;=================================</span></span><br><span class="line"><span class="comment">&quot; 插件部分--开始</span></span><br><span class="line"><span class="comment">&quot;=================================</span></span><br><span class="line"><span class="comment">&quot; 插件</span></span><br><span class="line"><span class="keyword">call</span> plug#begin(<span class="string">&#x27;~/.vim/plugged&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; coc.nvim代码补全</span></span><br><span class="line">Plug <span class="string">&#x27;neoclide/coc.nvim&#x27;</span>, &#123;<span class="string">&#x27;branch&#x27;</span>: <span class="string">&#x27;release&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; vim的dart支持</span></span><br><span class="line">Plug <span class="string">&#x27;dart-lang/dart-vim-plugin&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; NERDTree文件树</span></span><br><span class="line">Plug <span class="string">&#x27;scrooloose/nerdtree&#x27;</span>, &#123; <span class="string">&#x27;on&#x27;</span>: <span class="string">&#x27;NERDTreeToggle&#x27;</span> &#125;</span><br><span class="line">Plug <span class="string">&#x27;Xuyuanp/nerdtree-git-plugin&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; 修改启动界面</span></span><br><span class="line">Plug <span class="string">&#x27;mhinz/vim-startify&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; 状态栏、主题美化</span></span><br><span class="line">Plug <span class="string">&#x27;vim-airline/vim-airline&#x27;</span></span><br><span class="line">Plug <span class="string">&#x27;vim-airline/vim-airline-themes&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; 增加代码缩进线</span></span><br><span class="line">Plug <span class="string">&#x27;yggdroot/indentline&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; 快速注释</span></span><br><span class="line">Plug <span class="string">&#x27;scrooloose/nerdcommenter&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; 彩色括号</span></span><br><span class="line">Plug <span class="string">&#x27;luochen1990/rainbow&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; 配色</span></span><br><span class="line">Plug <span class="string">&#x27;crusoexia/vim-monokai&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; 展示当前文件的一些函数</span></span><br><span class="line">Plug <span class="string">&#x27;majutsushi/tagbar&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; 翻译</span></span><br><span class="line">Plug <span class="string">&#x27;voldikss/vim-translator&#x27;</span></span><br><span class="line"><span class="comment">&quot; 模糊搜索</span></span><br><span class="line">Plug <span class="string">&#x27;ctrlpvim/ctrlp.vim&#x27;</span></span><br><span class="line"><span class="keyword">call</span> plug#end()</span><br><span class="line"><span class="comment">&quot;=================================</span></span><br><span class="line"><span class="comment">&quot; 插件部分--结束</span></span><br><span class="line"><span class="comment">&quot;=================================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; =================================</span></span><br><span class="line"><span class="comment">&quot; vim-translator</span></span><br><span class="line"><span class="comment">&quot; =================================</span></span><br><span class="line"><span class="comment">&quot; 在窗口中显示翻译</span></span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;silent&gt;</span> <span class="symbol">&lt;Leader&gt;</span><span class="keyword">w</span> <span class="symbol">&lt;Plug&gt;</span>TranslateW</span><br><span class="line"><span class="comment">&quot; 将文字替换为翻译</span></span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;silent&gt;</span> <span class="symbol">&lt;Leader&gt;</span>r <span class="symbol">&lt;Plug&gt;</span>TranslateR</span><br><span class="line"><span class="comment">&quot; 翻译剪贴板中的文字</span></span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;silent&gt;</span> <span class="symbol">&lt;Leader&gt;</span><span class="keyword">x</span> <span class="symbol">&lt;Plug&gt;</span>TranslateX</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; =================================</span></span><br><span class="line"><span class="comment">&quot; vim-monokai</span></span><br><span class="line"><span class="comment">&quot; =================================</span></span><br><span class="line"><span class="comment">&quot;colo monokai</span></span><br><span class="line"><span class="keyword">colo</span> gruvbox</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; =================================</span></span><br><span class="line"><span class="comment">&quot; tagbar</span></span><br><span class="line"><span class="comment">&quot; =================================</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:tagbar_width</span>=<span class="number">30</span></span><br><span class="line"><span class="comment">&quot; 将tagbar的开关按键设置为 F5</span></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="symbol">&lt;silent&gt;</span> <span class="symbol">&lt;F5&gt;</span> :TagbarToggle<span class="symbol">&lt;CR&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; =================================</span></span><br><span class="line"><span class="comment">&quot; startify 设置 </span></span><br><span class="line"><span class="comment">&quot; =================================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; 设置Startify 快捷键</span></span><br><span class="line"><span class="keyword">map</span> <span class="symbol">&lt;F4&gt;</span> :Startify<span class="symbol">&lt;cr&gt;</span></span><br><span class="line"><span class="comment">&quot; =================================</span></span><br><span class="line"><span class="comment">&quot; NERDTree</span></span><br><span class="line"><span class="comment">&quot; =================================</span></span><br><span class="line"><span class="keyword">map</span> tt :NERDTreeToggle<span class="symbol">&lt;CR&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; \ + r 定位当前文件所在目录，这个很有用</span></span><br><span class="line"><span class="comment">&quot; 当前从左树进入，又要将当前目录定位到当前位置用这个</span></span><br><span class="line"><span class="keyword">map</span> <span class="symbol">&lt;leader&gt;</span>r :NERDTreeFind<span class="symbol">&lt;cr&gt;</span> <span class="symbol">&lt;C-w&gt;</span><span class="symbol">&lt;C-w&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;显示书签&quot;</span></span><br><span class="line"><span class="keyword">let</span> NERDTreeShowBookmarks=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; 忽略一下文件的显示</span></span><br><span class="line"><span class="keyword">let</span> NERDTreeIgnore=[<span class="string">&#x27;\.pyc&#x27;</span>,<span class="string">&#x27;\~$&#x27;</span>,<span class="string">&#x27;\.swp&#x27;</span>]</span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:NERDTreeIndicatorMapCustom</span> = &#123;</span><br><span class="line">    \ <span class="string">&quot;Modified&quot;</span>  : <span class="string">&quot;✹&quot;</span>,</span><br><span class="line">    \ <span class="string">&quot;Staged&quot;</span>    : <span class="string">&quot;✚&quot;</span>,</span><br><span class="line">    \ <span class="string">&quot;Untracked&quot;</span> : <span class="string">&quot;✭&quot;</span>,</span><br><span class="line">    \ <span class="string">&quot;Renamed&quot;</span>   : <span class="string">&quot;➜&quot;</span>,</span><br><span class="line">    \ <span class="string">&quot;Unmerged&quot;</span>  : <span class="string">&quot;═&quot;</span>,</span><br><span class="line">    \ <span class="string">&quot;Deleted&quot;</span>   : <span class="string">&quot;✖&quot;</span>,</span><br><span class="line">    \ <span class="string">&quot;Dirty&quot;</span>     : <span class="string">&quot;✗&quot;</span>,</span><br><span class="line">    \ <span class="string">&quot;Clean&quot;</span>     : <span class="string">&quot;✔︎&quot;</span>,</span><br><span class="line">    \ <span class="string">&#x27;Ignored&#x27;</span>   : <span class="string">&#x27;☒&#x27;</span>,</span><br><span class="line">    \ <span class="string">&quot;Unknown&quot;</span>   : <span class="string">&quot;?&quot;</span></span><br><span class="line">    \ &#125;</span><br><span class="line"><span class="comment">&quot; &#125;&#125;&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; =================================</span></span><br><span class="line"><span class="comment">&quot; vim-airline</span></span><br><span class="line"><span class="comment">&quot; =================================</span></span><br><span class="line"><span class="comment">&quot; 设置状态栏</span></span><br><span class="line"><span class="comment">&quot;字体设置，装完 powerline 后，添加这一项不会乱码，否则注释这一行</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline_powerline_fonts</span> = <span class="number">1</span></span><br><span class="line"><span class="comment">&quot; 关闭状态显示空白符号计数</span></span><br><span class="line"> <span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#whitespace#enabled = <span class="number">0</span></span><br><span class="line"> <span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#whitespace#symbol = <span class="string">&#x27;!&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> t_Co=<span class="number">256</span> <span class="string">&quot;终端开启256色支持&quot;</span></span><br><span class="line"><span class="keyword">set</span> laststatus=<span class="number">2</span>  <span class="string">&quot;1为关闭底部状态栏 2为开启&quot;</span></span><br><span class="line"><span class="comment">&quot; 开启tabline</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#tabline#enabled = <span class="number">1</span></span><br><span class="line"><span class="comment">&quot; tabline中未激活buffer两端的分隔字符</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#tabline#left_alt_sep = <span class="string">&#x27;|&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#tabline#buffer_nr_show = <span class="number">0</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#tabline#formatter = <span class="string">&#x27;default&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline_theme</span> = <span class="string">&#x27;desertink&#x27;</span>  <span class="comment">&quot; 主题</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#keymap#enabled = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#tabline#buffer_idx_mode = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:airline</span>#extensions#tabline#buffer_idx_format = &#123;</span><br><span class="line">       \ <span class="string">&#x27;0&#x27;</span>: <span class="string">&#x27;0 &#x27;</span>,</span><br><span class="line">       \ <span class="string">&#x27;1&#x27;</span>: <span class="string">&#x27;1 &#x27;</span>,</span><br><span class="line">       \ <span class="string">&#x27;2&#x27;</span>: <span class="string">&#x27;2 &#x27;</span>,</span><br><span class="line">       \ <span class="string">&#x27;3&#x27;</span>: <span class="string">&#x27;3 &#x27;</span>,</span><br><span class="line">       \ <span class="string">&#x27;4&#x27;</span>: <span class="string">&#x27;4 &#x27;</span>,</span><br><span class="line">       \ <span class="string">&#x27;5&#x27;</span>: <span class="string">&#x27;5 &#x27;</span>,</span><br><span class="line">       \ <span class="string">&#x27;6&#x27;</span>: <span class="string">&#x27;6 &#x27;</span>,</span><br><span class="line">       \ <span class="string">&#x27;7&#x27;</span>: <span class="string">&#x27;7 &#x27;</span>,</span><br><span class="line">       \ <span class="string">&#x27;8&#x27;</span>: <span class="string">&#x27;8 &#x27;</span>,</span><br><span class="line">       \ <span class="string">&#x27;9&#x27;</span>: <span class="string">&#x27;9 &#x27;</span></span><br><span class="line">       \&#125;</span><br><span class="line"><span class="comment">&quot; 设置切换tab的快捷键 &lt;\&gt; + &lt;i&gt; 切换到第i个 tab</span></span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;leader&gt;</span><span class="number">1</span> <span class="symbol">&lt;Plug&gt;</span>AirlineSelectTab1</span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;leader&gt;</span><span class="number">2</span> <span class="symbol">&lt;Plug&gt;</span>AirlineSelectTab2</span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;leader&gt;</span><span class="number">3</span> <span class="symbol">&lt;Plug&gt;</span>AirlineSelectTab3</span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;leader&gt;</span><span class="number">4</span> <span class="symbol">&lt;Plug&gt;</span>AirlineSelectTab4</span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;leader&gt;</span><span class="number">5</span> <span class="symbol">&lt;Plug&gt;</span>AirlineSelectTab5</span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;leader&gt;</span><span class="number">6</span> <span class="symbol">&lt;Plug&gt;</span>AirlineSelectTab6</span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;leader&gt;</span><span class="number">7</span> <span class="symbol">&lt;Plug&gt;</span>AirlineSelectTab7</span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;leader&gt;</span><span class="number">8</span> <span class="symbol">&lt;Plug&gt;</span>AirlineSelectTab8</span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;leader&gt;</span><span class="number">9</span> <span class="symbol">&lt;Plug&gt;</span>AirlineSelectTab9</span><br><span class="line"><span class="comment">&quot; 设置切换tab的快捷键 &lt;\&gt; + &lt;-&gt; 切换到前一个 tab</span></span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;leader&gt;</span>- <span class="symbol">&lt;Plug&gt;</span>AirlineSelectPrevTab</span><br><span class="line"><span class="comment">&quot; 设置切换tab的快捷键 &lt;\&gt; + &lt;+&gt; 切换到后一个 tab</span></span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;leader&gt;</span>+ <span class="symbol">&lt;Plug&gt;</span>AirlineSelectNextTab</span><br><span class="line"><span class="comment">&quot; 设置切换tab的快捷键 &lt;\&gt; + &lt;q&gt; 退出当前的 tab</span></span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;leader&gt;</span>q :<span class="keyword">bp</span><span class="symbol">&lt;cr&gt;</span>:<span class="keyword">bd</span> #<span class="symbol">&lt;cr&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">map</span> <span class="symbol">&lt;tab&gt;</span> :<span class="keyword">bn</span><span class="symbol">&lt;cr&gt;</span> <span class="string">&quot;设置tab键映射&quot;</span></span><br><span class="line"><span class="keyword">map</span>  <span class="symbol">&lt;S-tab&gt;</span> :<span class="keyword">bp</span><span class="symbol">&lt;cr&gt;</span> <span class="string">&quot;设置tab键映射&quot;</span></span><br><span class="line"><span class="keyword">map</span>  <span class="symbol">&lt;S-q&gt;</span> :<span class="keyword">bp</span>\|<span class="keyword">bd</span> #<span class="symbol">&lt;cr&gt;</span> <span class="string">&quot;关闭buffer&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; =================================</span></span><br><span class="line"><span class="comment">&quot; nerdcommenter</span></span><br><span class="line"><span class="comment">&quot; =================================</span></span><br><span class="line"><span class="comment">&quot;add spaces after comment delimiters by default</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:NERDSpaceDelims</span> = <span class="number">1</span></span><br><span class="line"><span class="comment">&quot; python 自动的会多加一个空格</span></span><br><span class="line"><span class="keyword">au</span> FileType <span class="keyword">python</span> <span class="keyword">let</span> <span class="variable">g:NERDSpaceDelims</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Use compact syntax for prettified multi-line comments</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:NERDCompactSexyComs</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Align line-wise comment delimiters flush left instead of following code indentation</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:NERDDefaultAlign</span> = <span class="string">&#x27;left&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Set a language to use its alternate delimiters by default</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:NERDAltDelims_java</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; 自定义格式</span></span><br><span class="line"><span class="comment">&quot; let g:NERDCustomDelimiters = &#123; &#x27;c&#x27;: &#123; &#x27;left&#x27;: &#x27;/**&#x27;,&#x27;right&#x27;: &#x27;*/&#x27; &#125; &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Allow commenting and inverting empty lines (useful when commenting a region)</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:NERDCommentEmptyLines</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Enable trimming of trailing whitespace when uncommenting</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:NERDTrimTrailingWhitespace</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Enable NERDCommenterToggle to check all selected lines is commented or not</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:NERDToggleCheckAllLines</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; =================================</span></span><br><span class="line"><span class="comment">&quot; indentline</span></span><br><span class="line"><span class="comment">&quot; =================================</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:indentLine_char</span>=<span class="string">&#x27;┆&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:indentLine_enabled</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; =================================</span></span><br><span class="line"><span class="comment">&quot; rainbow</span></span><br><span class="line"><span class="comment">&quot; =================================</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:rainbow_active</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:rainbow_conf</span> = &#123;</span><br><span class="line">\   <span class="string">&#x27;guifgs&#x27;</span>: [<span class="string">&#x27;darkorange3&#x27;</span>, <span class="string">&#x27;seagreen3&#x27;</span>, <span class="string">&#x27;royalblue3&#x27;</span>, <span class="string">&#x27;firebrick&#x27;</span>],</span><br><span class="line">\   <span class="string">&#x27;ctermfgs&#x27;</span>: [<span class="string">&#x27;lightyellow&#x27;</span>, <span class="string">&#x27;lightcyan&#x27;</span>,<span class="string">&#x27;lightblue&#x27;</span>, <span class="string">&#x27;lightmagenta&#x27;</span>],</span><br><span class="line">\   <span class="string">&#x27;operators&#x27;</span>: <span class="string">&#x27;_,_&#x27;</span>,</span><br><span class="line">\   <span class="string">&#x27;parentheses&#x27;</span>: [<span class="string">&#x27;start=/(/ end=/)/ fold&#x27;</span>, <span class="string">&#x27;start=/\[/ end=/\]/ fold&#x27;</span>, <span class="string">&#x27;start=/&#123;/ end=/&#125;/ fold&#x27;</span>],</span><br><span class="line">\   <span class="string">&#x27;separately&#x27;</span>: &#123;</span><br><span class="line">\       <span class="string">&#x27;*&#x27;</span>: &#123;&#125;,</span><br><span class="line">\       <span class="string">&#x27;tex&#x27;</span>: &#123;</span><br><span class="line">\           <span class="string">&#x27;parentheses&#x27;</span>: [<span class="string">&#x27;start=/(/ end=/)/&#x27;</span>, <span class="string">&#x27;start=/\[/ end=/\]/&#x27;</span>],</span><br><span class="line">\       &#125;,</span><br><span class="line">\       <span class="string">&#x27;lisp&#x27;</span>: &#123;</span><br><span class="line">\           <span class="string">&#x27;guifgs&#x27;</span>: [<span class="string">&#x27;darkorange3&#x27;</span>, <span class="string">&#x27;seagreen3&#x27;</span>, <span class="string">&#x27;royalblue3&#x27;</span>, <span class="string">&#x27;firebrick&#x27;</span>],</span><br><span class="line">\       &#125;,</span><br><span class="line">\       <span class="string">&#x27;vim&#x27;</span>: &#123;</span><br><span class="line">\           <span class="string">&#x27;parentheses&#x27;</span>: [<span class="string">&#x27;start=/(/ end=/)/&#x27;</span>, <span class="string">&#x27;start=/\[/ end=/\]/&#x27;</span>, <span class="string">&#x27;start=/&#123;/ end=/&#125;/ fold&#x27;</span>, <span class="string">&#x27;start=/(/ end=/)/ containedin=vimFuncBody&#x27;</span>, <span class="string">&#x27;start=/\[/ end=/\]/ containedin=vimFuncBody&#x27;</span>, <span class="string">&#x27;start=/&#123;/ end=/&#125;/ fold containedin=vimFuncBody&#x27;</span>],</span><br><span class="line">\       &#125;,</span><br><span class="line">\       <span class="string">&#x27;html&#x27;</span>: &#123;</span><br><span class="line">\           <span class="string">&#x27;parentheses&#x27;</span>: [<span class="string">&#x27;start=/\v\&lt;((area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)[ &gt;])@!\z([-_:a-zA-Z0-9]+)(\s+[-_:a-zA-Z0-9]+(\=(&quot;[^&quot;]*&quot;|&#x27;</span>.<span class="string">&quot;&#x27;&quot;</span>.<span class="string">&#x27;[^&#x27;</span>.<span class="string">&quot;&#x27;&quot;</span>.<span class="string">&#x27;]*&#x27;</span>.<span class="string">&quot;&#x27;&quot;</span>.<span class="string">&#x27;|[^ &#x27;</span>.<span class="string">&quot;&#x27;&quot;</span>.<span class="string">&#x27;&quot;&gt;&lt;=`]*))?)*\&gt;/ end=#&lt;/\z1&gt;# fold&#x27;</span>],</span><br><span class="line">\       &#125;,</span><br><span class="line">\       <span class="string">&#x27;css&#x27;</span>: <span class="number">0</span>,</span><br><span class="line">\   &#125;</span><br><span class="line">\&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; =================================</span></span><br><span class="line"><span class="comment">&quot; coc.nvim</span></span><br><span class="line"><span class="comment">&quot; =================================</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:coc_global_extensions</span> = [</span><br><span class="line">            \ <span class="string">&#x27;coc-json&#x27;</span>,</span><br><span class="line">            \ <span class="string">&#x27;coc-vimlsp&#x27;</span>,</span><br><span class="line">            \ <span class="string">&#x27;coc-tsserver&#x27;</span>,</span><br><span class="line">            \ <span class="string">&#x27;coc-python&#x27;</span>,</span><br><span class="line">            \ <span class="string">&#x27;coc-java&#x27;</span>,</span><br><span class="line">            \ <span class="string">&#x27;coc-html&#x27;</span>,</span><br><span class="line">            \ <span class="string">&#x27;coc-css&#x27;</span>,</span><br><span class="line">            \ <span class="string">&#x27;coc-pairs&#x27;</span>,</span><br><span class="line">            \ <span class="string">&#x27;coc-snippets&#x27;</span>,</span><br><span class="line">            \ <span class="string">&#x27;coc-markdownlint&#x27;</span>,</span><br><span class="line">            \ <span class="string">&#x27;coc-explorer&#x27;</span>,</span><br><span class="line">            \ <span class="string">&#x27;coc-flutter-tools&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> hidden</span><br><span class="line"><span class="keyword">set</span> updatetime=<span class="number">200</span></span><br><span class="line"><span class="keyword">set</span> shortmess+=<span class="keyword">c</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:coc_snippet_next</span> = <span class="string">&#x27;&lt;c-n&gt;&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:coc_snippet_prev</span> = <span class="string">&#x27;&lt;c-p&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; diagnostics appear/become resolved.</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">has</span>(<span class="string">&quot;patch-8.1.1564&quot;</span>)</span><br><span class="line">  <span class="comment">&quot; Recently vim can merge signcolumn and number column into one</span></span><br><span class="line">  <span class="keyword">set</span> signcolumn=<span class="keyword">number</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="keyword">set</span> signcolumn=yes</span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; 让Tab键可以补全</span></span><br><span class="line"><span class="comment">&quot; Use tab for trigger completion with characters ahead and navigate.</span></span><br><span class="line"><span class="comment">&quot; <span class="doctag">NOTE:</span> Use command &#x27;:verbose imap &lt;tab&gt;&#x27; to make sure tab is not mapped by</span></span><br><span class="line"><span class="comment">&quot; other plugin before putting this into your config.</span></span><br><span class="line"><span class="keyword">inoremap</span> <span class="symbol">&lt;silent&gt;</span><span class="symbol">&lt;expr&gt;</span> <span class="symbol">&lt;TAB&gt;</span></span><br><span class="line">      \ <span class="built_in">pumvisible</span>() ? <span class="string">&quot;\&lt;C-n&gt;&quot;</span> :</span><br><span class="line">      \ <span class="symbol">&lt;SID&gt;</span>check_back_space() ? <span class="string">&quot;\&lt;TAB&gt;&quot;</span> :</span><br><span class="line">      \ coc#refresh()</span><br><span class="line"><span class="keyword">inoremap</span> <span class="symbol">&lt;expr&gt;</span><span class="symbol">&lt;S-TAB&gt;</span> <span class="built_in">pumvisible</span>() ? <span class="string">&quot;\&lt;C-p&gt;&quot;</span> : <span class="string">&quot;\&lt;C-h&gt;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span>! <span class="title">s</span>:<span class="title">check_back_space</span><span class="params">()</span> <span class="title">abort</span></span></span><br><span class="line">  <span class="keyword">let</span> <span class="keyword">col</span> = <span class="keyword">col</span>(<span class="string">&#x27;.&#x27;</span>) - <span class="number">1</span></span><br><span class="line">  <span class="keyword">return</span> !col || <span class="built_in">getline</span>(<span class="string">&#x27;.&#x27;</span>)[<span class="keyword">col</span> - <span class="number">1</span>]  =~# <span class="string">&#x27;\s&#x27;</span></span><br><span class="line"><span class="keyword">endfunction</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Ctrl+o 调出自动补全</span></span><br><span class="line"><span class="keyword">inoremap</span> <span class="symbol">&lt;silent&gt;</span><span class="symbol">&lt;expr&gt;</span> <span class="symbol">&lt;c-o&gt;</span> coc#refresh()</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Use &lt;cr&gt; to confirm completion, `&lt;C-g&gt;u` means break undo chain at current</span></span><br><span class="line"><span class="comment">&quot; position. Coc only does snippet and additional edit on confirm.</span></span><br><span class="line"><span class="comment">&quot; &lt;cr&gt; could be remapped by other vim plugin, try `:verbose imap &lt;CR&gt;`.</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">exists</span>(<span class="string">&#x27;*complete_info&#x27;</span>)</span><br><span class="line">  <span class="keyword">inoremap</span> <span class="symbol">&lt;expr&gt;</span> <span class="symbol">&lt;cr&gt;</span> complete_info()[<span class="string">&quot;selected&quot;</span>] != <span class="string">&quot;-1&quot;</span> ? <span class="string">&quot;\&lt;C-y&gt;&quot;</span> : <span class="string">&quot;\&lt;C-g&gt;u\&lt;CR&gt;&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="keyword">inoremap</span> <span class="symbol">&lt;expr&gt;</span> <span class="symbol">&lt;cr&gt;</span> <span class="built_in">pumvisible</span>() ? <span class="string">&quot;\&lt;C-y&gt;&quot;</span> : <span class="string">&quot;\&lt;C-g&gt;u\&lt;CR&gt;&quot;</span></span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Use `[g` and `]g` to navigate diagnostics</span></span><br><span class="line"><span class="comment">&quot; Use `:CocDiagnostics` to get all diagnostics of current buffer in location list.</span></span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;silent&gt;</span> [g <span class="symbol">&lt;Plug&gt;</span>(coc-diagnostic-<span class="keyword">prev</span>)</span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;silent&gt;</span> ]g <span class="symbol">&lt;Plug&gt;</span>(coc-diagnostic-<span class="keyword">next</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; GoTo code navigation.</span></span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;silent&gt;</span> gd <span class="symbol">&lt;Plug&gt;</span>(coc-definition)</span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;silent&gt;</span> gy <span class="symbol">&lt;Plug&gt;</span>(coc-<span class="built_in">type</span>-definition)</span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;silent&gt;</span> gi <span class="symbol">&lt;Plug&gt;</span>(coc-implementation)</span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;silent&gt;</span> <span class="keyword">gr</span> <span class="symbol">&lt;Plug&gt;</span>(coc-references)</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Use K to show documentation in preview window.</span></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="symbol">&lt;silent&gt;</span> K :<span class="keyword">call</span> <span class="symbol">&lt;SID&gt;</span>show_documentation()<span class="symbol">&lt;CR&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span>! <span class="title">s</span>:<span class="title">show_documentation</span><span class="params">()</span></span></span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">index</span>([<span class="string">&#x27;vim&#x27;</span>,<span class="string">&#x27;help&#x27;</span>], &amp;<span class="keyword">filetype</span>) &gt;= <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">execute</span> <span class="string">&#x27;h &#x27;</span>.<span class="built_in">expand</span>(<span class="string">&#x27;&lt;cword&gt;&#x27;</span>)</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">call</span> CocAction(<span class="string">&#x27;doHover&#x27;</span>)</span><br><span class="line">  <span class="keyword">endif</span></span><br><span class="line"><span class="keyword">endfunction</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Highlight the symbol and its references when holding the cursor.</span></span><br><span class="line"><span class="keyword">autocmd</span> CursorHold * <span class="keyword">silent</span> <span class="keyword">call</span> CocActionAsync(<span class="string">&#x27;highlight&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Symbol renaming.</span></span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;leader&gt;</span>rn <span class="symbol">&lt;Plug&gt;</span>(coc-<span class="built_in">rename</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Formatting selected code.</span></span><br><span class="line"><span class="keyword">xmap</span> <span class="symbol">&lt;leader&gt;</span><span class="keyword">f</span>  <span class="symbol">&lt;Plug&gt;</span>(coc-format-selected)</span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;leader&gt;</span><span class="keyword">f</span>  <span class="symbol">&lt;Plug&gt;</span>(coc-format-selected)</span><br><span class="line"></span><br><span class="line"><span class="keyword">augroup</span> mygroup</span><br><span class="line">  autocmd!</span><br><span class="line">  <span class="comment">&quot; Setup formatexpr specified filetype(s).</span></span><br><span class="line">  <span class="keyword">autocmd</span> FileType typescript,json <span class="keyword">setl</span> formatexpr=CocAction(<span class="string">&#x27;formatSelected&#x27;</span>)</span><br><span class="line">  <span class="comment">&quot; Update signature help on jump placeholder.</span></span><br><span class="line">  <span class="keyword">autocmd</span> User CocJumpPlaceholder <span class="keyword">call</span> CocActionAsync(<span class="string">&#x27;showSignatureHelp&#x27;</span>)</span><br><span class="line"><span class="keyword">augroup</span> end</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Applying codeAction to the selected region.</span></span><br><span class="line"><span class="comment">&quot; Example: `&lt;leader&gt;aap` for current paragraph</span></span><br><span class="line"><span class="keyword">xmap</span> <span class="symbol">&lt;leader&gt;</span><span class="keyword">a</span>  <span class="symbol">&lt;Plug&gt;</span>(coc-codeaction-selected)</span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;leader&gt;</span><span class="keyword">a</span>  <span class="symbol">&lt;Plug&gt;</span>(coc-codeaction-selected)</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Remap keys for applying codeAction to the current buffer.</span></span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;leader&gt;</span>ac  <span class="symbol">&lt;Plug&gt;</span>(coc-codeaction)</span><br><span class="line"><span class="comment">&quot; Apply AutoFix to problem on the current line.</span></span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;leader&gt;</span>qf  <span class="symbol">&lt;Plug&gt;</span>(coc-<span class="keyword">fix</span>-current)</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Map function and class text objects</span></span><br><span class="line"><span class="comment">&quot; <span class="doctag">NOTE:</span> Requires &#x27;textDocument.documentSymbol&#x27; support from the language server.</span></span><br><span class="line"><span class="keyword">xmap</span> <span class="keyword">if</span> <span class="symbol">&lt;Plug&gt;</span>(coc-funcobj-i)</span><br><span class="line"><span class="keyword">omap</span> <span class="keyword">if</span> <span class="symbol">&lt;Plug&gt;</span>(coc-funcobj-i)</span><br><span class="line"><span class="keyword">xmap</span> af <span class="symbol">&lt;Plug&gt;</span>(coc-funcobj-<span class="keyword">a</span>)</span><br><span class="line"><span class="keyword">omap</span> af <span class="symbol">&lt;Plug&gt;</span>(coc-funcobj-<span class="keyword">a</span>)</span><br><span class="line"><span class="keyword">xmap</span> ic <span class="symbol">&lt;Plug&gt;</span>(coc-classobj-i)</span><br><span class="line"><span class="keyword">omap</span> ic <span class="symbol">&lt;Plug&gt;</span>(coc-classobj-i)</span><br><span class="line"><span class="keyword">xmap</span> ac <span class="symbol">&lt;Plug&gt;</span>(coc-classobj-<span class="keyword">a</span>)</span><br><span class="line"><span class="keyword">omap</span> ac <span class="symbol">&lt;Plug&gt;</span>(coc-classobj-<span class="keyword">a</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Use CTRL-S for selections ranges.</span></span><br><span class="line"><span class="comment">&quot; Requires &#x27;textDocument/selectionRange&#x27; support of LS, ex: coc-tsserver</span></span><br><span class="line"><span class="keyword">nmap</span> <span class="symbol">&lt;silent&gt;</span> <span class="symbol">&lt;C-s&gt;</span> <span class="symbol">&lt;Plug&gt;</span>(coc-<span class="built_in">range</span>-select)</span><br><span class="line"><span class="keyword">xmap</span> <span class="symbol">&lt;silent&gt;</span> <span class="symbol">&lt;C-s&gt;</span> <span class="symbol">&lt;Plug&gt;</span>(coc-<span class="built_in">range</span>-select)</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Add `:Format` command to format current buffer.</span></span><br><span class="line">command! -nargs=<span class="number">0</span> Format :<span class="keyword">call</span> CocAction(<span class="string">&#x27;format&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Add `:Fold` command to fold current buffer.</span></span><br><span class="line">command! -nargs=? Fold :<span class="keyword">call</span>     CocAction(<span class="string">&#x27;fold&#x27;</span>, <span class="symbol">&lt;f-args&gt;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Add `:OR` command for organize imports of the current buffer.</span></span><br><span class="line">command! -nargs=<span class="number">0</span> OR   :<span class="keyword">call</span>     CocAction(<span class="string">&#x27;runCommand&#x27;</span>, <span class="string">&#x27;editor.action.organizeImport&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Add (Neo)Vim&#x27;s native statusline support.</span></span><br><span class="line"><span class="comment">&quot; <span class="doctag">NOTE:</span> Please see `:h coc-status` for integrations with external plugins that</span></span><br><span class="line"><span class="comment">&quot; provide custom statusline: lightline.vim, vim-airline.</span></span><br><span class="line"><span class="keyword">set</span> statusline^=%&#123;coc#status()&#125;%&#123;<span class="built_in">get</span>(<span class="variable">b:</span>,<span class="string">&#x27;coc_current_function&#x27;</span>,<span class="string">&#x27;&#x27;</span>)&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">&quot; Mappings for CoCList</span></span><br><span class="line"><span class="comment">&quot; Show all diagnostics.</span></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="symbol">&lt;silent&gt;</span><span class="symbol">&lt;nowait&gt;</span> <span class="symbol">&lt;space&gt;</span><span class="keyword">a</span>  :<span class="symbol">&lt;C-u&gt;</span>CocList diagnostics<span class="symbol">&lt;cr&gt;</span></span><br><span class="line"><span class="comment">&quot; Manage extensions.</span></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="symbol">&lt;silent&gt;</span><span class="symbol">&lt;nowait&gt;</span> <span class="symbol">&lt;space&gt;</span><span class="keyword">e</span>  :<span class="symbol">&lt;C-u&gt;</span>CocList extensions<span class="symbol">&lt;cr&gt;</span></span><br><span class="line"><span class="comment">&quot; Show commands.</span></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="symbol">&lt;silent&gt;</span><span class="symbol">&lt;nowait&gt;</span> <span class="symbol">&lt;space&gt;</span><span class="keyword">c</span>  :<span class="symbol">&lt;C-u&gt;</span>CocList commands<span class="symbol">&lt;cr&gt;</span></span><br><span class="line"><span class="comment">&quot; Find symbol of current document.</span></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="symbol">&lt;silent&gt;</span><span class="symbol">&lt;nowait&gt;</span> <span class="symbol">&lt;space&gt;</span><span class="keyword">o</span>  :<span class="symbol">&lt;C-u&gt;</span>CocList outline<span class="symbol">&lt;cr&gt;</span></span><br><span class="line"><span class="comment">&quot; Search workspace symbols.</span></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="symbol">&lt;silent&gt;</span><span class="symbol">&lt;nowait&gt;</span> <span class="symbol">&lt;space&gt;</span>s  :<span class="symbol">&lt;C-u&gt;</span>CocList -I symbols<span class="symbol">&lt;cr&gt;</span></span><br><span class="line"><span class="comment">&quot; Do default action for next item.</span></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="symbol">&lt;silent&gt;</span><span class="symbol">&lt;nowait&gt;</span> <span class="symbol">&lt;space&gt;</span><span class="keyword">j</span>  :<span class="symbol">&lt;C-u&gt;</span>CocNext<span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="comment">&quot; Do default action for previous item.</span></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="symbol">&lt;silent&gt;</span><span class="symbol">&lt;nowait&gt;</span> <span class="symbol">&lt;space&gt;</span><span class="keyword">k</span>  :<span class="symbol">&lt;C-u&gt;</span>CocPrev<span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="comment">&quot; Resume latest coc list.</span></span><br><span class="line"><span class="keyword">nnoremap</span> <span class="symbol">&lt;silent&gt;</span><span class="symbol">&lt;nowait&gt;</span> <span class="symbol">&lt;space&gt;</span><span class="keyword">p</span>  :<span class="symbol">&lt;C-u&gt;</span>CocListResume<span class="symbol">&lt;CR&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;现在开发、写文章基本上已经离不开 vim了，写代码idea + vim 配合，写文章就是直接上 vim。vim 有一定的学习曲线，但是习惯了就好。&lt;br&gt;习惯以后，再使用这些插件就会更好用。&lt;/p&gt;
&lt;h2 id=&quot;配置存放仓库&quot;&gt;&lt;a href=&quot;#配置存放仓库&quot; class=&quot;headerlink&quot; title=&quot;配置存放仓库:&quot;&gt;&lt;/a&gt;配置存放仓库:&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/forfreeday/vim&quot;&gt;https://github.com/forfreeday/vim&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;coc-java-问题&quot;&gt;&lt;a href=&quot;#coc-java-问题&quot; class=&quot;headerlink&quot; title=&quot;coc java 问题&quot;&gt;&lt;/a&gt;coc java 问题&lt;/h2&gt;&lt;p&gt;JDK 版本要高于1.8否则，JDT会启动失败。&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="linux" scheme="http://liukay.com/categories/linux/"/>
    
      <category term="vim" scheme="http://liukay.com/categories/linux/vim/"/>
    
    
      <category term="linux" scheme="http://liukay.com/tags/linux/"/>
    
      <category term="vim配置" scheme="http://liukay.com/tags/vim%E9%85%8D%E7%BD%AE/"/>
    
  </entry>
  
  <entry>
    <title>算法--leetcode-283-移动零</title>
    <link href="http://liukay.com/2020/12/16/%E7%AE%97%E6%B3%95--leetcode-283-%E7%A7%BB%E5%8A%A8%E9%9B%B6/"/>
    <id>http://liukay.com/2020/12/16/算法--leetcode-283-移动零/</id>
    <published>2020-12-16T03:30:33.000Z</published>
    <updated>2020-12-17T03:00:57.074Z</updated>
    
    <content type="html"><![CDATA[<p>相当于是使用 for 进行交换的一个小技巧的练习，后面会给出一些算法的小技巧，都是总结的一些算法的小技巧。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Integer[] arr = &#123;<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">9</span>&#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (arr[i] != <span class="number">0</span>) &#123;</span><br><span class="line">               <span class="keyword">int</span> temp = arr[j];</span><br><span class="line">               arr[j] = arr[i];</span><br><span class="line">               arr[i] = temp;</span><br><span class="line">               j++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(Arrays.toString(arr));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;相当于是使用 for 进行交换的一个小技巧的练习，后面会给出一些算法的小技巧，都是总结的一些算法的小技巧。&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;
      
    
    </summary>
    
      <category term="algorithm" scheme="http://liukay.com/categories/algorithm/"/>
    
      <category term="leetcode" scheme="http://liukay.com/categories/algorithm/leetcode/"/>
    
    
      <category term="算法" scheme="http://liukay.com/tags/%E7%AE%97%E6%B3%95/"/>
    
      <category term="leetcode" scheme="http://liukay.com/tags/leetcode/"/>
    
  </entry>
  
  <entry>
    <title>算法-leetcode007-整数反转</title>
    <link href="http://liukay.com/2020/12/16/%E7%AE%97%E6%B3%95--leetcode007-%E6%95%B4%E6%95%B0%E5%8F%8D%E8%BD%AC/"/>
    <id>http://liukay.com/2020/12/16/算法--leetcode007-整数反转/</id>
    <published>2020-12-16T03:14:32.000Z</published>
    <updated>2020-12-16T03:21:23.915Z</updated>
    
    <content type="html"><![CDATA[<p>当所计算数字大于2^30 次方或等于2^31 次方但余下的数大于7或小于-2^30 次方或等于-2^31 次方但余下的数小于-8时，只要再计算一次就溢出。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">reverse</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> pop;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (x != <span class="number">0</span>) &#123;</span><br><span class="line">        pop = x % <span class="number">10</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;pop: &quot;</span> + pop);</span><br><span class="line">        x = x / <span class="number">10</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;x: &quot;</span> + x);</span><br><span class="line">        <span class="keyword">if</span> (res &gt; Integer.MAX_VALUE / <span class="number">10</span> || (res == Integer.MAX_VALUE / <span class="number">10</span> &amp;&amp; pop &gt; <span class="number">7</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (res &lt; Integer.MIN_VALUE / <span class="number">10</span> || (res == Integer.MIN_VALUE / <span class="number">10</span> &amp;&amp; pop &lt; -<span class="number">8</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;res before: &quot;</span> + res);</span><br><span class="line">        res = res * <span class="number">10</span> + pop;</span><br><span class="line">        System.out.println(<span class="string">&quot;res after: &quot;</span> + res);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://leetcode-cn.com/problems/reverse-integer/">Leetcode007</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;当所计算数字大于2^30 次方或等于2^31 次方但余下的数大于7或小于-2^30 次方或等于-2^31 次方但余下的数小于-8时，只要再计算一次就溢出。&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gu
      
    
    </summary>
    
      <category term="algorithm" scheme="http://liukay.com/categories/algorithm/"/>
    
      <category term="leetcode" scheme="http://liukay.com/categories/algorithm/leetcode/"/>
    
    
      <category term="算法" scheme="http://liukay.com/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>算法-栈stack-用栈实现队列-Leetcode232</title>
    <link href="http://liukay.com/2020/12/15/%E7%AE%97%E6%B3%95--leetcode232-%E7%94%A8%E6%A0%88%E5%AE%9E%E7%8E%B0%E9%98%9F%E5%88%97/"/>
    <id>http://liukay.com/2020/12/15/算法--leetcode232-用栈实现队列/</id>
    <published>2020-12-15T05:57:25.000Z</published>
    <updated>2020-12-16T03:12:03.093Z</updated>
    
    <content type="html"><![CDATA[<h2 id="用栈实现队列"><a href="#用栈实现队列" class="headerlink" title="用栈实现队列"></a>用栈实现队列</h2><p>这个是 Leetcode 232 题，用两个栈来实现一个先进先出的队列，实现了一个版本。</p><p><a href="https://leetcode-cn.com/problems/implement-queue-using-stacks/">https://leetcode-cn.com/problems/implement-queue-using-stacks/</a></p><a id="more"></a><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyQueue</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    Stack&lt;Integer&gt; stack1 = <span class="keyword">new</span> Stack&lt;&gt;();</span><br><span class="line">    Stack&lt;Integer&gt; stack2 = <span class="keyword">new</span> Stack&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Initialize your data structure here.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyQueue</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Push element x to the back of queue.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        stack1.push(x);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Removes the element from in front of queue and returns that element.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">pop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (!stack1.empty()) &#123;</span><br><span class="line">            stack2.push(stack1.pop());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> result = stack2.pop();</span><br><span class="line">        <span class="keyword">while</span> (!stack2.empty()) &#123;</span><br><span class="line">            stack1.push(stack2.pop());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get the front element.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">peek</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (!stack1.empty()) &#123;</span><br><span class="line">            stack2.push(stack1.pop());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> result = stack2.peek();</span><br><span class="line">        <span class="keyword">while</span> (!stack2.empty()) &#123;</span><br><span class="line">            stack1.push(stack2.pop());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns whether the queue is empty.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">empty</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> stack1.empty();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;用栈实现队列&quot;&gt;&lt;a href=&quot;#用栈实现队列&quot; class=&quot;headerlink&quot; title=&quot;用栈实现队列&quot;&gt;&lt;/a&gt;用栈实现队列&lt;/h2&gt;&lt;p&gt;这个是 Leetcode 232 题，用两个栈来实现一个先进先出的队列，实现了一个版本。&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://leetcode-cn.com/problems/implement-queue-using-stacks/&quot;&gt;https://leetcode-cn.com/problems/implement-queue-using-stacks/&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="algorithm" scheme="http://liukay.com/categories/algorithm/"/>
    
      <category term="栈" scheme="http://liukay.com/categories/algorithm/%E6%A0%88/"/>
    
    
      <category term="算法" scheme="http://liukay.com/tags/%E7%AE%97%E6%B3%95/"/>
    
      <category term="栈" scheme="http://liukay.com/tags/%E6%A0%88/"/>
    
  </entry>
  
  <entry>
    <title>集群容错模式</title>
    <link href="http://liukay.com/2020/05/06/architecture-%E9%9B%86%E7%BE%A4%E5%AE%B9%E9%94%99%E6%A8%A1%E5%BC%8F/"/>
    <id>http://liukay.com/2020/05/06/architecture-集群容错模式/</id>
    <published>2020-05-06T09:39:25.000Z</published>
    <updated>2020-12-17T04:11:52.922Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Failfast-Cluster模式"><a href="#Failfast-Cluster模式" class="headerlink" title="Failfast Cluster模式"></a>Failfast Cluster模式</h3><p>这种模式称为快速失败模式，调用只执行一次，失败则立即报错。这种模式适用于非幂等性操作，每次调用的副作用是不同的，如写操作，比如交易系统我们要下订单，如果一次失败就应该让它失败，通常由服务消费方控制是否重新发起下订单操作请求（另一个新的订单）。<br>-Failsafe Cluster模式<br>失败安全模式，如果调用失败， 则直接忽略失败的调用，而是要记录下失败的调用到日志文件，以便后续审计。<br><a id="more"></a></p><h3 id="Failback-Cluster模式"><a href="#Failback-Cluster模式" class="headerlink" title="Failback Cluster模式"></a>Failback Cluster模式</h3><p>失败自动恢复，后台记录失败请求，定时重发。通常用于消息通知操作。</p><h3 id="Forking-Cluster模式"><a href="#Forking-Cluster模式" class="headerlink" title="Forking Cluster模式"></a>Forking Cluster模式</h3><p>并行调用多个服务器，只要一个成功即返回。通常用于实时性要求较高的读操作，但需要浪费更多服务资源。</p><h3 id="Broadcast-Cluster模式"><a href="#Broadcast-Cluster模式" class="headerlink" title="Broadcast Cluster模式"></a>Broadcast Cluster模式</h3><p>广播调用所有提供者，逐个调用，任意一台报错则报错（2.1.0开始支持）。通常用于通知所有提供者更新缓存或日志等本地资源信息。</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;Failfast-Cluster模式&quot;&gt;&lt;a href=&quot;#Failfast-Cluster模式&quot; class=&quot;headerlink&quot; title=&quot;Failfast Cluster模式&quot;&gt;&lt;/a&gt;Failfast Cluster模式&lt;/h3&gt;&lt;p&gt;这种模式称为快速失败模式，调用只执行一次，失败则立即报错。这种模式适用于非幂等性操作，每次调用的副作用是不同的，如写操作，比如交易系统我们要下订单，如果一次失败就应该让它失败，通常由服务消费方控制是否重新发起下订单操作请求（另一个新的订单）。&lt;br&gt;-Failsafe Cluster模式&lt;br&gt;失败安全模式，如果调用失败， 则直接忽略失败的调用，而是要记录下失败的调用到日志文件，以便后续审计。&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="architecture" scheme="http://liukay.com/categories/architecture/"/>
    
      <category term="概念" scheme="http://liukay.com/categories/architecture/%E6%A6%82%E5%BF%B5/"/>
    
    
      <category term="架构" scheme="http://liukay.com/tags/%E6%9E%B6%E6%9E%84/"/>
    
      <category term="概念" scheme="http://liukay.com/tags/%E6%A6%82%E5%BF%B5/"/>
    
      <category term="容错" scheme="http://liukay.com/tags/%E5%AE%B9%E9%94%99/"/>
    
  </entry>
  
  <entry>
    <title>NIO概述</title>
    <link href="http://liukay.com/2019/11/01/java-nio-1-NIO%E6%A6%82%E8%BF%B0/"/>
    <id>http://liukay.com/2019/11/01/java-nio-1-NIO概述/</id>
    <published>2019-11-01T15:12:02.000Z</published>
    <updated>2020-12-16T03:41:57.975Z</updated>
    
    <content type="html"><![CDATA[<p>服务器实现模式为一个请求一个线程，但客户端发送的连接请求都会注册到多路复用器上，多路复用器轮询到连接有I/O请求时才启动一个线程进行处理。</p><p>Java NIO（Non-blocking / New IO）是从Java 1.4版本开始引入的一个新的IO API，可以替代标准的Java IO API。<br>NIO 和 IO 的区别在于，IO 是面向流，NIO 是面向缓存。<br>是一种同步非阻塞的I/O模型，也是I/O多路复用的基础，已经被越来越多地应用到大型应用服务器，<br>成为解决高并发与大量连接、I/O处理问题的有效方式。<br><a id="more"></a></p><h2 id="传统面向流的，单向的。"><a href="#传统面向流的，单向的。" class="headerlink" title="传统面向流的，单向的。"></a>传统面向流的，单向的。</h2><p>三个核心组件</p><ol><li>Channels</li><li>Buffers</li><li>Selectors</li></ol><h3 id="1-Channels-负责传输"><a href="#1-Channels-负责传输" class="headerlink" title="1.Channels  负责传输"></a>1.Channels  负责传输</h3><p>白话: 就是数据传输用的通道。作用是打开到IO设备的连接，文件、套接字都行。<br>绕绕话:   标准的IO基于字节流和字符流进行操作的，而NIO是基于通道（Channel）和缓冲区（Buffer）进行操作，数据总是从通道读取到缓冲区中，或者从缓冲区写入到通道中。</p><h3 id="2-Buffers-负责存储"><a href="#2-Buffers-负责存储" class="headerlink" title="2.Buffers  负责存储"></a>2.Buffers  负责存储</h3><p>缓冲区，用来存放具体要被传输的数据，比如文件、scoket 等。这里将数据装入 Buffers 再通过通道进行传输。</p><h3 id="3-Selector"><a href="#3-Selector" class="headerlink" title="3.Selector"></a>3.Selector</h3><p>负责监听事件和选择对应事件的渠道。</p><p>NIO 主要的编程模型来自 Reactor</p><h2 id="Reactor"><a href="#Reactor" class="headerlink" title="Reactor"></a>Reactor</h2><p>NIO基于Reactor，当socket有流可读或可写入socket时，操作系统会相应的通知引用程序进行处理，应用再将流读取到缓冲区或写入操作系统。<br>也就是说，这个时候，已经不是一个连接就要对应一个处理线程了，而是有效的请求，对应一个线程，当连接没有数据时，是没有工作线程来处理的。</p><h3 id="NIO-是一种可以替代-Java-IO-API-的新API，提供了与标准-API-不同的工作方式。"><a href="#NIO-是一种可以替代-Java-IO-API-的新API，提供了与标准-API-不同的工作方式。" class="headerlink" title="NIO 是一种可以替代 Java IO API 的新API，提供了与标准 API 不同的工作方式。"></a>NIO 是一种可以替代 Java IO API 的新API，提供了与标准 API 不同的工作方式。</h3><h3 id="BIO是一个连接一个线程。"><a href="#BIO是一个连接一个线程。" class="headerlink" title="BIO是一个连接一个线程。"></a>BIO是一个连接一个线程。</h3><h3 id="NIO是一个请求一个线程。"><a href="#NIO是一个请求一个线程。" class="headerlink" title="NIO是一个请求一个线程。"></a>NIO是一个请求一个线程。</h3><h3 id="AIO是一个有效请求一个线程。"><a href="#AIO是一个有效请求一个线程。" class="headerlink" title="AIO是一个有效请求一个线程。"></a>AIO是一个有效请求一个线程。</h3><h2 id="三种IO-的区别"><a href="#三种IO-的区别" class="headerlink" title="三种IO 的区别"></a>三种IO 的区别</h2><p>Java BIO:同步并阻塞<br>服务器实现模式为一个连接一个线程，即客户端有连接请求时服务器端就需要启动一个线程进行处理，如果这个连接不做任何事情会造成不必要的线程开销，当然可以通过线程池机制改善。</p><p>Java NIO: 同步非阻塞<br>服务器实现模式为一个请求一个线程，即客户端发送的连接请求都会注册到多路复用器上，多路复用器轮询到连接有I/O请求时才启动一个线程进行处理。</p><p>Java AIO(NIO.2) :异步非阻塞<br>服务器实现模式为一个有效请求一个线程，客户端的I/O请求都是由OS先完成了再通知服务器应用去启动线程进行处。</p><h3 id="BIO、NIO、AIO适用场景分析"><a href="#BIO、NIO、AIO适用场景分析" class="headerlink" title="BIO、NIO、AIO适用场景分析:"></a>BIO、NIO、AIO适用场景分析:</h3><p>BIO方式适用于连接数目比较小且固定的架构，这种方式对服务器资源要求比较高，并发局限于应用中，JDK1.4以前的唯一选择，但程序直观简单易理解。<br>NIO方式适用于连接数目多且连接比较短（轻操作）的架构，比如聊天服务器，并发局限于应用中，编程比较复杂，JDK1.4开始支持。<br>AIO方式使用于连接数目多且连接比较长（重操作）的架构，比如相册服务器，充分调用OS参与并发操作，编程比较复杂，JDK7开始支持。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;服务器实现模式为一个请求一个线程，但客户端发送的连接请求都会注册到多路复用器上，多路复用器轮询到连接有I/O请求时才启动一个线程进行处理。&lt;/p&gt;
&lt;p&gt;Java NIO（Non-blocking / New IO）是从Java 1.4版本开始引入的一个新的IO API，可以替代标准的Java IO API。&lt;br&gt;NIO 和 IO 的区别在于，IO 是面向流，NIO 是面向缓存。&lt;br&gt;是一种同步非阻塞的I/O模型，也是I/O多路复用的基础，已经被越来越多地应用到大型应用服务器，&lt;br&gt;成为解决高并发与大量连接、I/O处理问题的有效方式。&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="java" scheme="http://liukay.com/categories/java/"/>
    
      <category term="nio" scheme="http://liukay.com/categories/java/nio/"/>
    
    
      <category term="nio" scheme="http://liukay.com/tags/nio/"/>
    
      <category term="概述" scheme="http://liukay.com/tags/%E6%A6%82%E8%BF%B0/"/>
    
  </entry>
  
  <entry>
    <title>Spring Gateway 静态路由--路径切割</title>
    <link href="http://liukay.com/2019/07/22/Spring-Spring-Cloud-Gateway-%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1-%E8%B7%AF%E5%BE%84%E5%88%87%E5%89%B2/"/>
    <id>http://liukay.com/2019/07/22/Spring-Spring-Cloud-Gateway-静态路由-路径切割/</id>
    <published>2019-07-22T03:40:18.000Z</published>
    <updated>2020-12-15T04:09:18.979Z</updated>
    
    <content type="html"><![CDATA[<p>以代码 或 配置文件形式进行配置。<br>RewritePath：路径匹配切割<br>StripPrefix： 路径载取</p><p>参数说明<br><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">id:</span> <span class="string">路由ID</span></span><br><span class="line"><span class="attr">uri:</span> <span class="string">目标地址，可以是服务，如果服务Spring推荐用全大写，实际调用大小写不敏感，都可以调通。</span></span><br><span class="line"><span class="attr">predicates:</span> <span class="string">匹配路径，以浏览器请求的端口号后面的第一级路径为起始。</span></span><br><span class="line"><span class="attr">filters:</span> <span class="string">过滤器，包含Spring</span> <span class="string">Gateway</span> <span class="string">内置过滤器，可以自定义过滤器。</span></span><br></pre></td></tr></table></figure></p><h2 id="1-请求转发，转发到目标地址"><a href="#1-请求转发，转发到目标地址" class="headerlink" title="1. 请求转发，转发到目标地址"></a>1. 请求转发，转发到目标地址</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">routes:</span></span><br><span class="line">  <span class="comment"># 跳转URL</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">163_route</span></span><br><span class="line">    <span class="attr">uri:</span> <span class="string">http://www.163.com/</span></span><br><span class="line">    <span class="attr">predicates:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">Path=/163</span></span><br></pre></td></tr></table></figure><a id="more"></a><h2 id="2-切路径"><a href="#2-切路径" class="headerlink" title="2.切路径"></a>2.切路径</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># oauth2 认证</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">id:</span> <span class="string">OAUTH2</span></span><br><span class="line">    <span class="attr">uri:</span> <span class="string">lb://OAUTH-SERVER</span></span><br><span class="line">    <span class="attr">predicates:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">Path=/oauth-server/**</span></span><br><span class="line">    <span class="attr">filters:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">StripPrefix=1</span></span><br></pre></td></tr></table></figure><p>参数说明</p><ol><li>StripPrefix的意思是将路径切掉一级，这个例子中 oauth-server 被剪。</li><li>请求路径：localhost:9000/oauth-server/oauth-center/oauth/token?username=admin</li><li>最终结果：lb://OAUTH-SERVER/oauth-center/oauth/token?username=admin</li></ol><h2 id="3-请求重写"><a href="#3-请求重写" class="headerlink" title="3.请求重写"></a>3.请求重写</h2>  <figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># oauth2 认证</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">id:</span> <span class="string">OAUTH2</span></span><br><span class="line">    <span class="attr">uri:</span> <span class="string">lb://OAUTH-SERVER/</span></span><br><span class="line">    <span class="attr">predicates:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">Path=/oauth-server/**</span></span><br><span class="line">    <span class="attr">filters:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">RewritePath=/oauth-server/(?&lt;path&gt;.*),</span> <span class="string">/$\&#123;path&#125;</span></span><br></pre></td></tr></table></figure><ol><li>请求路径: localhost:9000/oauth-server/oauth-center/oauth/token?username=admin</li><li>最终结果: lb://OAUTH-SERVER/oauth-center/oauth/token?username=admin</li></ol><h3 id="验证了一下，RewritePath-的处理方式："><a href="#验证了一下，RewritePath-的处理方式：" class="headerlink" title="验证了一下，RewritePath 的处理方式："></a>验证了一下，RewritePath 的处理方式：</h3><ol><li>RewritePath 找到自己的 /oauth-server/ 这一段，从 - Path 中去匹配，如果能匹配的到就是会将路径进行切割，注意是切割</li><li>切割方式将 /oauth-server/(?<path></path>.*) ，中 <path></path> 中的路径切出来，也就是 oauth-server/后面的部份。</li><li>并将切的结果赋值到 {path} 中。</li><li>最后的拼接路径为     lb://SPRINGCLOUD-PROVIDER/path</li></ol><h3 id="Path-设置多个无效"><a href="#Path-设置多个无效" class="headerlink" title="-Path 设置多个无效"></a>-Path 设置多个无效</h3><p>验证 predicates 的 -Path 设置多个无效，如果 -Path 中的路径匹配对了，但是 RewritePath 中的路径和 -Path 匹配不上会报 HTTP Status 404</p><h2 id="4-路径重定–结果路径多一级"><a href="#4-路径重定–结果路径多一级" class="headerlink" title="4.路径重定–结果路径多一级"></a>4.路径重定–结果路径多一级</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="number">4</span><span class="string">.路径重写</span></span><br><span class="line">    <span class="string">这个测试，是在请求路径中不存在的url，添加到最终的请求路径中去</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">OAUTH2</span></span><br><span class="line">     <span class="attr">uri:</span> <span class="string">lb://OAUTH-SERVER/</span></span><br><span class="line">     <span class="attr">predicates:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">Path=/oauth-server/**</span></span><br><span class="line">     <span class="attr">filters:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">RewritePath=/oauth-server/(?&lt;path&gt;.*),</span> <span class="string">/oauth-center/$\&#123;path&#125;</span></span><br></pre></td></tr></table></figure><ul><li>请求路径: localhost:9000/oauth-server/oauth/token?username=admin</li><li>最终结果: lb://OAUTH-SERVER/oauth-center/oauth/token?username=admin<br>oauth-center 在请求的路径中不存在，在 RewritePath 中进行重写，添加了一级路径。</li></ul><h3 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h3><ol><li>RewritePath: predicates 中的 - path 路径如果和 RewritePath 匹配则会被 RewritePath 剪切。</li><li>StripPrefix：剪取指定路径位数截取</li></ol><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">举个示例</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">id:</span> <span class="string">rewritepath_route</span></span><br><span class="line">  <span class="attr">uri:</span> <span class="string">http://example.org</span></span><br><span class="line">  <span class="attr">predicates:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">Path=/a/b/**</span></span><br><span class="line">  <span class="attr">filters:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">RewritePath=/a/b/(?&lt;segment&gt;.*),</span> <span class="string">/f/$\&#123;segment&#125;</span></span><br></pre></td></tr></table></figure><h3 id="结果"><a href="#结果" class="headerlink" title="结果:"></a>结果:</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">请求的时为：</span> <span class="string">/a/b/c</span></span><br><span class="line"><span class="string">最终结果为：</span> <span class="string">/f/c</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;以代码 或 配置文件形式进行配置。&lt;br&gt;RewritePath：路径匹配切割&lt;br&gt;StripPrefix： 路径载取&lt;/p&gt;
&lt;p&gt;参数说明&lt;br&gt;&lt;figure class=&quot;highlight yml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;id:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;路由ID&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;uri:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;目标地址，可以是服务，如果服务Spring推荐用全大写，实际调用大小写不敏感，都可以调通。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;predicates:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;匹配路径，以浏览器请求的端口号后面的第一级路径为起始。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;filters:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;过滤器，包含Spring&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;Gateway&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;内置过滤器，可以自定义过滤器。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;1-请求转发，转发到目标地址&quot;&gt;&lt;a href=&quot;#1-请求转发，转发到目标地址&quot; class=&quot;headerlink&quot; title=&quot;1. 请求转发，转发到目标地址&quot;&gt;&lt;/a&gt;1. 请求转发，转发到目标地址&lt;/h2&gt;&lt;figure class=&quot;highlight yml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;routes:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# 跳转URL&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;id:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;163_route&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;uri:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;http://www.163.com/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attr&quot;&gt;predicates:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;bullet&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;Path=/163&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="java" scheme="http://liukay.com/categories/java/"/>
    
      <category term="spring" scheme="http://liukay.com/categories/java/spring/"/>
    
    
      <category term="spring cloud" scheme="http://liukay.com/tags/spring-cloud/"/>
    
      <category term="spring gateway" scheme="http://liukay.com/tags/spring-gateway/"/>
    
      <category term="路由" scheme="http://liukay.com/tags/%E8%B7%AF%E7%94%B1/"/>
    
  </entry>
  
  <entry>
    <title>面试-产生线程死锁的原因和处理方式</title>
    <link href="http://liukay.com/2019/07/02/%E9%9D%A2%E8%AF%95-%E4%BA%A7%E7%94%9F%E7%BA%BF%E7%A8%8B%E6%AD%BB%E9%94%81%E7%9A%84%E5%8E%9F%E5%9B%A0%E5%92%8C%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F/"/>
    <id>http://liukay.com/2019/07/02/面试-产生线程死锁的原因和处理方式/</id>
    <published>2019-07-02T03:28:10.000Z</published>
    <updated>2020-12-17T04:35:47.537Z</updated>
    
    <content type="html"><![CDATA[<h3 id="背景"><a href="#背景" class="headerlink" title="背景:"></a>背景:</h3><p>线程同步(就是加锁)会有一个问题，就是产生死锁<br>所谓死锁: 是指两个或两个以上的进程在执行过程中，因争夺资源而造成的一种互相等待的现象，若无外力作用，它们都将无法推进下去。</p><h3 id="帮助理解："><a href="#帮助理解：" class="headerlink" title="帮助理解："></a>帮助理解：</h3><p>地上放着两个桶泡面，一个老坛酸菜，一个小鸡炖磨茹。有两个人：<code>一个产品</code>(线程1)，<code>一个测试</code>(线程2)，同时扑向<code>抢老坛酸菜</code>(锁A)和<code>小鸡炖磨茹</code>(锁B)，产品拿到老坛酸菜，测试拿到小鸡炖磨茹，同一时刻，产品伸要去拽测试怀里的小鸡炖磨茹，测试伸手去拽产品的老坛酸菜，互使剪刀脚两个僵持不下，就卡死在那了，叫这就死锁。如果没有<code>一个开发</code>将他们各打一顿解救出来(中断状态)，它们将无法推进下去。</p><h3 id="发生死锁的具体原因如下"><a href="#发生死锁的具体原因如下" class="headerlink" title="发生死锁的具体原因如下:"></a>发生死锁的具体原因如下:</h3><a id="more"></a><ol><li>因为系统资源不足。</li><li>进程运行推进的顺序不合适。    </li><li>资源分配不当。</li></ol><h3 id="举列说明场景"><a href="#举列说明场景" class="headerlink" title="举列说明场景:"></a>举列说明场景:</h3><p>死锁是因为多线程访问共享资源，由于访问的顺序不当所造成的，通常是一个线程锁定了一个资源A，而又想去锁定资源B；在另一个线程中，锁定了资源B，而又想去锁定资源A以完成自身的操作，两个线程都想得到对方的资源，而不愿释放自己的资源，造成两个线程都在等待，而无法执行的情况。</p><h3 id="死锁预防"><a href="#死锁预防" class="headerlink" title="死锁预防"></a>死锁预防</h3><p>如果只使用一个锁就不会有死锁的问题，不过复杂场景下不太理实。<br>1.以确定的顺序获得锁<br><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">线程A</span> <span class="string">---&gt;</span> <span class="string">锁定</span> <span class="string">A</span>  <span class="string">----&gt;</span> <span class="string">偿试锁定</span> <span class="string">B</span></span><br><span class="line"><span class="string">线程B</span> <span class="string">---&gt;</span> <span class="string">锁定</span> <span class="string">A</span>  <span class="string">----&gt;</span> <span class="string">偿试锁定</span> <span class="string">B</span></span><br><span class="line"><span class="string">这样就不会发生死锁</span></span><br></pre></td></tr></table></figure></p><p>2.超时放弃<br>Lock接口提供了boolean tryLock(long time, TimeUnit unit) throws InterruptedException方法，该方法可以按照固定时长等待锁，因此线程可以在获取锁超时以后，主动释放之前已经获得的所有的锁。通过这种方式，也可以很有效地避免死锁。</p><p>死锁示列:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">packag com.liukai.thread.daed_locl;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 死锁</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SyncDeadLock</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Object locka = <span class="keyword">new</span> Object();</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Object lockb = <span class="keyword">new</span> Object();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        <span class="keyword">new</span> SyncDeadLock().deadLock();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">deadLock</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        Thread thread1 = <span class="keyword">new</span> Thread(()-&gt;&#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (locka)&#123;</span><br><span class="line">                <span class="keyword">try</span>&#123;</span><br><span class="line">                    System.out.println(Thread.currentThread().getName()+<span class="string">&quot; 拿到 lock-A!&quot;</span>);</span><br><span class="line">                    Thread.sleep(<span class="number">500</span>);</span><br><span class="line">                    System.out.println(Thread.currentThread().getName()+<span class="string">&quot; 睡眠 500ms 后续继执行...!&quot;</span>);</span><br><span class="line">                &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println(Thread.currentThread().getName()+<span class="string">&quot; 偿试获取 lock-B!&quot;</span>);</span><br><span class="line">                <span class="keyword">synchronized</span> (lockb)&#123;</span><br><span class="line">                    System.out.println(Thread.currentThread().getName()+<span class="string">&quot; 已获得 lock-B!&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="string">&quot;thread1&quot;</span>);</span><br><span class="line"></span><br><span class="line">        Thread thread2 = <span class="keyword">new</span> Thread(()-&gt;&#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (lockb)&#123;</span><br><span class="line">                <span class="keyword">try</span>&#123;</span><br><span class="line">                    System.out.println(Thread.currentThread().getName()+<span class="string">&quot; 拿到 lock-B!&quot;</span>);</span><br><span class="line">                    Thread.sleep(<span class="number">500</span>);</span><br><span class="line">                    System.out.println(Thread.currentThread().getName()+<span class="string">&quot; 睡眠 500ms 后续继执行...!&quot;</span>);</span><br><span class="line">                &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println(Thread.currentThread().getName()+<span class="string">&quot; 偿试获取 lock-A!&quot;</span>);</span><br><span class="line">                <span class="keyword">synchronized</span> (locka)&#123;</span><br><span class="line">                    System.out.println(Thread.currentThread().getName()+<span class="string">&quot; 已获得 lock-A!&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,<span class="string">&quot;thread2&quot;</span>);</span><br><span class="line"></span><br><span class="line">        thread1.start();</span><br><span class="line">        thread2.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景:&quot;&gt;&lt;/a&gt;背景:&lt;/h3&gt;&lt;p&gt;线程同步(就是加锁)会有一个问题，就是产生死锁&lt;br&gt;所谓死锁: 是指两个或两个以上的进程在执行过程中，因争夺资源而造成的一种互相等待的现象，若无外力作用，它们都将无法推进下去。&lt;/p&gt;
&lt;h3 id=&quot;帮助理解：&quot;&gt;&lt;a href=&quot;#帮助理解：&quot; class=&quot;headerlink&quot; title=&quot;帮助理解：&quot;&gt;&lt;/a&gt;帮助理解：&lt;/h3&gt;&lt;p&gt;地上放着两个桶泡面，一个老坛酸菜，一个小鸡炖磨茹。有两个人：&lt;code&gt;一个产品&lt;/code&gt;(线程1)，&lt;code&gt;一个测试&lt;/code&gt;(线程2)，同时扑向&lt;code&gt;抢老坛酸菜&lt;/code&gt;(锁A)和&lt;code&gt;小鸡炖磨茹&lt;/code&gt;(锁B)，产品拿到老坛酸菜，测试拿到小鸡炖磨茹，同一时刻，产品伸要去拽测试怀里的小鸡炖磨茹，测试伸手去拽产品的老坛酸菜，互使剪刀脚两个僵持不下，就卡死在那了，叫这就死锁。如果没有&lt;code&gt;一个开发&lt;/code&gt;将他们各打一顿解救出来(中断状态)，它们将无法推进下去。&lt;/p&gt;
&lt;h3 id=&quot;发生死锁的具体原因如下&quot;&gt;&lt;a href=&quot;#发生死锁的具体原因如下&quot; class=&quot;headerlink&quot; title=&quot;发生死锁的具体原因如下:&quot;&gt;&lt;/a&gt;发生死锁的具体原因如下:&lt;/h3&gt;
    
    </summary>
    
      <category term="interview" scheme="http://liukay.com/categories/interview/"/>
    
      <category term="多线程" scheme="http://liukay.com/categories/interview/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
    
      <category term="面试" scheme="http://liukay.com/tags/%E9%9D%A2%E8%AF%95/"/>
    
      <category term="线程死锁" scheme="http://liukay.com/tags/%E7%BA%BF%E7%A8%8B%E6%AD%BB%E9%94%81/"/>
    
  </entry>
  
  <entry>
    <title>使用递归实现地址数据菜单</title>
    <link href="http://liukay.com/2019/06/14/%E7%AE%97%E6%B3%95-%E5%8D%95%E8%A1%A8%E6%A0%91%E5%9E%8B%E5%AE%9E%E7%8E%B0/"/>
    <id>http://liukay.com/2019/06/14/算法-单表树型实现/</id>
    <published>2019-06-13T17:31:32.000Z</published>
    <updated>2020-12-15T04:09:18.998Z</updated>
    
    <content type="html"><![CDATA[<p>跟网上的不同的是，我这种方式是以时间换空间的做法，不会一次性把数据全查出来再慢慢遍历，而是每次查询是否存在子级，有就递归下去查。<br>数据量大时，查库的次数比较多，数据量少时对数据库查询次数少，压力较小，但是多次查询不会出现一次查询数据量很大卡住的情况。</p><h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><ol><li>先获取一级菜单，对每个一级菜单设子区域。</li><li>如果子区域还有子区域，就递归查询，直到查不到子区域返回。</li><li>递归的核心就是在方法中设置一个返回条件，防止无限递归下去。</li></ol><a id="more"></a><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"> * <span class="meta">@author</span> liukai</span><br><span class="line"> * <span class="meta">@since</span> <span class="number">2019</span>/<span class="number">6</span>/<span class="number">12</span> <span class="number">16</span>:<span class="number">14.</span></span><br><span class="line"> */</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SignTree</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> RegionDao regionDao = <span class="keyword">new</span> RegionDao();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1. 先拿到第一级地址</span></span><br><span class="line">        <span class="comment">//2. 递归查每一级下面的子级：</span></span><br><span class="line">        <span class="comment">//      如果子级下面，还有子级就递归</span></span><br><span class="line">        <span class="comment">//      如果子级下面，没有子级就返回退出递归</span></span><br><span class="line">        List&lt;RegionBean&gt; firstRegion = regionDao.queryParentId(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (RegionBean regionBean : firstRegion) &#123;</span><br><span class="line">            <span class="comment">//设置子区域</span></span><br><span class="line">            regionBean.setRegionBeanList(setChild(regionBean.getId()));</span><br><span class="line">        &#125;</span><br><span class="line">        String jsonObject = JSONObject.toJSONString(firstRegion);</span><br><span class="line"></span><br><span class="line">        System.out.println(jsonObject);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 递归查询所有子级</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> parentId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> List&lt;RegionBean&gt; <span class="title">setChild</span><span class="params">(<span class="keyword">int</span> parentId)</span> </span>&#123;</span><br><span class="line">        List&lt;RegionBean&gt; childList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        List&lt;RegionBean&gt; childTemp = regionDao.queryParentId(parentId);</span><br><span class="line">        <span class="keyword">if</span> (childTemp != <span class="keyword">null</span> &amp;&amp; childTemp.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (RegionBean regionBean : childTemp) &#123;</span><br><span class="line">                childList.add(regionBean);</span><br><span class="line">                regionBean.setRegionBeanList(setChild(regionBean.getId()));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> childList;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> childList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RegionDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询父级</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> parentId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;RegionBean&gt; <span class="title">queryParentId</span><span class="params">(<span class="keyword">int</span> parentId)</span> </span>&#123;</span><br><span class="line">        List&lt;RegionBean&gt; regionBeans = dataBaseRegion();</span><br><span class="line">        List&lt;RegionBean&gt; firstRegion = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (RegionBean regionBean : regionBeans) &#123;</span><br><span class="line">            <span class="keyword">if</span> (regionBean.getParentId() == parentId) &#123;</span><br><span class="line">                firstRegion.add(regionBean);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> firstRegion;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;RegionBean&gt; <span class="title">dataBaseRegion</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;RegionBean&gt; regionBeans = Arrays.asList(</span><br><span class="line">                <span class="keyword">new</span> RegionBean(<span class="number">2</span>, <span class="string">&quot;北京市&quot;</span>, <span class="string">&quot;北京市&quot;</span>, <span class="number">0</span>, <span class="number">1</span>),</span><br><span class="line">                <span class="keyword">new</span> RegionBean(<span class="number">22</span>, <span class="string">&quot;天津市&quot;</span>, <span class="string">&quot;天津市&quot;</span>, <span class="number">0</span>, <span class="number">2</span>),</span><br><span class="line">                <span class="keyword">new</span> RegionBean(<span class="number">783</span>, <span class="string">&quot;上海市&quot;</span>, <span class="string">&quot;上海市&quot;</span>, <span class="number">0</span>, <span class="number">3</span>),</span><br><span class="line">                <span class="keyword">new</span> RegionBean(<span class="number">457</span>, <span class="string">&quot;辽宁省&quot;</span>, <span class="string">&quot;辽宁省&quot;</span>, <span class="number">0</span>, <span class="number">8</span>),</span><br><span class="line">                <span class="keyword">new</span> RegionBean(<span class="number">458</span>, <span class="string">&quot;沈阳市&quot;</span>, <span class="string">&quot;辽宁省-沈阳市&quot;</span>, <span class="number">457</span>, <span class="number">1</span>),</span><br><span class="line">                <span class="keyword">new</span> RegionBean(<span class="number">472</span>, <span class="string">&quot;铁岭市&quot;</span>, <span class="string">&quot;辽宁省-铁岭市&quot;</span>, <span class="number">457</span>, <span class="number">2</span>),</span><br><span class="line">                <span class="keyword">new</span> RegionBean(<span class="number">480</span>, <span class="string">&quot;大连市&quot;</span>, <span class="string">&quot;辽宁省-大连市&quot;</span>, <span class="number">457</span>, <span class="number">3</span>),</span><br><span class="line">                <span class="keyword">new</span> RegionBean(<span class="number">491</span>, <span class="string">&quot;鞍山市&quot;</span>, <span class="string">&quot;辽宁省-鞍山市&quot;</span>, <span class="number">457</span>, <span class="number">4</span>),</span><br><span class="line">                <span class="keyword">new</span> RegionBean(<span class="number">499</span>, <span class="string">&quot;抚顺市&quot;</span>, <span class="string">&quot;辽宁省-抚顺市&quot;</span>, <span class="number">457</span>, <span class="number">5</span>),</span><br><span class="line">                <span class="keyword">new</span> RegionBean(<span class="number">507</span>, <span class="string">&quot;本溪市&quot;</span>, <span class="string">&quot;辽宁省-本溪市&quot;</span>, <span class="number">457</span>, <span class="number">6</span>),</span><br><span class="line">                <span class="keyword">new</span> RegionBean(<span class="number">514</span>, <span class="string">&quot;丹东市&quot;</span>, <span class="string">&quot;辽宁省-丹东市&quot;</span>, <span class="number">457</span>, <span class="number">7</span>),</span><br><span class="line">                <span class="keyword">new</span> RegionBean(<span class="number">521</span>, <span class="string">&quot;锦州市&quot;</span>, <span class="string">&quot;辽宁省-锦州市&quot;</span>, <span class="number">457</span>, <span class="number">8</span>),</span><br><span class="line">                <span class="keyword">new</span> RegionBean(<span class="number">529</span>, <span class="string">&quot;营口市&quot;</span>, <span class="string">&quot;辽宁省-营口市&quot;</span>, <span class="number">457</span>, <span class="number">9</span>),</span><br><span class="line">                <span class="keyword">new</span> RegionBean(<span class="number">536</span>, <span class="string">&quot;阜新市&quot;</span>, <span class="string">&quot;辽宁省-阜新市&quot;</span>, <span class="number">457</span>, <span class="number">10</span>),</span><br><span class="line">                <span class="keyword">new</span> RegionBean(<span class="number">544</span>, <span class="string">&quot;辽阳市&quot;</span>, <span class="string">&quot;辽宁省-辽阳市&quot;</span>, <span class="number">457</span>, <span class="number">11</span>),</span><br><span class="line">                <span class="keyword">new</span> RegionBean(<span class="number">552</span>, <span class="string">&quot;朝阳市&quot;</span>, <span class="string">&quot;辽宁省-朝阳市&quot;</span>, <span class="number">457</span>, <span class="number">12</span>),</span><br><span class="line">                <span class="keyword">new</span> RegionBean(<span class="number">560</span>, <span class="string">&quot;盘锦市&quot;</span>, <span class="string">&quot;辽宁省-盘锦市&quot;</span>, <span class="number">457</span>, <span class="number">13</span>),</span><br><span class="line">                <span class="keyword">new</span> RegionBean(<span class="number">561</span>, <span class="string">&quot;三级数据&quot;</span>, <span class="string">&quot;辽宁省-三级数据&quot;</span>, <span class="number">560</span>, <span class="number">13</span>),</span><br><span class="line">                <span class="keyword">new</span> RegionBean(<span class="number">562</span>, <span class="string">&quot;三级数据&quot;</span>, <span class="string">&quot;辽宁省-三级数据&quot;</span>, <span class="number">560</span>, <span class="number">13</span>),</span><br><span class="line">                <span class="keyword">new</span> RegionBean(<span class="number">563</span>, <span class="string">&quot;三级数据&quot;</span>, <span class="string">&quot;辽宁省-三级数据&quot;</span>, <span class="number">560</span>, <span class="number">13</span>),</span><br><span class="line">                <span class="keyword">new</span> RegionBean(<span class="number">564</span>, <span class="string">&quot;三级数据&quot;</span>, <span class="string">&quot;辽宁省-三级数据&quot;</span>, <span class="number">560</span>, <span class="number">13</span>),</span><br><span class="line">                <span class="keyword">new</span> RegionBean(<span class="number">565</span>, <span class="string">&quot;三级数据&quot;</span>, <span class="string">&quot;辽宁省-三级数据&quot;</span>, <span class="number">560</span>, <span class="number">13</span>),</span><br><span class="line">                <span class="keyword">new</span> RegionBean(<span class="number">566</span>, <span class="string">&quot;三级数据&quot;</span>, <span class="string">&quot;辽宁省-三级数据&quot;</span>, <span class="number">560</span>, <span class="number">13</span>),</span><br><span class="line">                <span class="keyword">new</span> RegionBean(<span class="number">666</span>, <span class="string">&quot;四级数据&quot;</span>, <span class="string">&quot;辽宁省-四级数据&quot;</span>, <span class="number">566</span>, <span class="number">13</span>)</span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">return</span> regionBeans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RegionBean</span> <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> String label;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> String fullLabel;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> parentId;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> sortId;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> List&lt;RegionBean&gt; regionBeanList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>结果<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[&#123;&quot;fullLabel&quot;:&quot;北京市&quot;,&quot;id&quot;:2,&quot;label&quot;:&quot;北京市&quot;,&quot;parentId&quot;:0,&quot;regionBeanList&quot;:[],&quot;sortId&quot;:1&#125;,&#123;&quot;fullLabel&quot;:&quot;天津市&quot;,&quot;id&quot;:22,&quot;label&quot;:&quot;天津市&quot;,&quot;parentId&quot;:0,&quot;regionBeanList&quot;:[],&quot;sortId&quot;:2&#125;,&#123;&quot;fullLabel&quot;:&quot;上海市&quot;,&quot;id&quot;:783,&quot;label&quot;:&quot;上海市&quot;,&quot;parentId&quot;:0,&quot;regionBeanList&quot;:[],&quot;sortId&quot;:3&#125;,&#123;&quot;fullLabel&quot;:&quot;辽宁省&quot;,&quot;id&quot;:457,&quot;label&quot;:&quot;辽宁省&quot;,&quot;parentId&quot;:0,&quot;regionBeanList&quot;:[&#123;&quot;fullLabel&quot;:&quot;辽宁省-沈阳市&quot;,&quot;id&quot;:458,&quot;label&quot;:&quot;沈阳市&quot;,&quot;parentId&quot;:457,&quot;regionBeanList&quot;:[],&quot;sortId&quot;:1&#125;,&#123;&quot;fullLabel&quot;:&quot;辽宁省-铁岭市&quot;,&quot;id&quot;:472,&quot;label&quot;:&quot;铁岭市&quot;,&quot;parentId&quot;:457,&quot;regionBeanList&quot;:[],&quot;sortId&quot;:2&#125;,&#123;&quot;fullLabel&quot;:&quot;辽宁省-大连市&quot;,&quot;id&quot;:480,&quot;label&quot;:&quot;大连市&quot;,&quot;parentId&quot;:457,&quot;regionBeanList&quot;:[],&quot;sortId&quot;:3&#125;,&#123;&quot;fullLabel&quot;:&quot;辽宁省-鞍山市&quot;,&quot;id&quot;:491,&quot;label&quot;:&quot;鞍山市&quot;,&quot;parentId&quot;:457,&quot;regionBeanList&quot;:[],&quot;sortId&quot;:4&#125;,&#123;&quot;fullLabel&quot;:&quot;辽宁省-抚顺市&quot;,&quot;id&quot;:499,&quot;label&quot;:&quot;抚顺市&quot;,&quot;parentId&quot;:457,&quot;regionBeanList&quot;:[],&quot;sortId&quot;:5&#125;,&#123;&quot;fullLabel&quot;:&quot;辽宁省-本溪市&quot;,&quot;id&quot;:507,&quot;label&quot;:&quot;本溪市&quot;,&quot;parentId&quot;:457,&quot;regionBeanList&quot;:[],&quot;sortId&quot;:6&#125;,&#123;&quot;fullLabel&quot;:&quot;辽宁省-丹东市&quot;,&quot;id&quot;:514,&quot;label&quot;:&quot;丹东市&quot;,&quot;parentId&quot;:457,&quot;regionBeanList&quot;:[],&quot;sortId&quot;:7&#125;,&#123;&quot;fullLabel&quot;:&quot;辽宁省-锦州市&quot;,&quot;id&quot;:521,&quot;label&quot;:&quot;锦州市&quot;,&quot;parentId&quot;:457,&quot;regionBeanList&quot;:[],&quot;sortId&quot;:8&#125;,&#123;&quot;fullLabel&quot;:&quot;辽宁省-营口市&quot;,&quot;id&quot;:529,&quot;label&quot;:&quot;营口市&quot;,&quot;parentId&quot;:457,&quot;regionBeanList&quot;:[],&quot;sortId&quot;:9&#125;,&#123;&quot;fullLabel&quot;:&quot;辽宁省-阜新市&quot;,&quot;id&quot;:536,&quot;label&quot;:&quot;阜新市&quot;,&quot;parentId&quot;:457,&quot;regionBeanList&quot;:[],&quot;sortId&quot;:10&#125;,&#123;&quot;fullLabel&quot;:&quot;辽宁省-辽阳市&quot;,&quot;id&quot;:544,&quot;label&quot;:&quot;辽阳市&quot;,&quot;parentId&quot;:457,&quot;regionBeanList&quot;:[],&quot;sortId&quot;:11&#125;,&#123;&quot;fullLabel&quot;:&quot;辽宁省-朝阳市&quot;,&quot;id&quot;:552,&quot;label&quot;:&quot;朝阳市&quot;,&quot;parentId&quot;:457,&quot;regionBeanList&quot;:[],&quot;sortId&quot;:12&#125;,&#123;&quot;fullLabel&quot;:&quot;辽宁省-盘锦市&quot;,&quot;id&quot;:560,&quot;label&quot;:&quot;盘锦市&quot;,&quot;parentId&quot;:457,&quot;regionBeanList&quot;:[&#123;&quot;fullLabel&quot;:&quot;辽宁省-三级数据&quot;,&quot;id&quot;:561,&quot;label&quot;:&quot;三级数据&quot;,&quot;parentId&quot;:560,&quot;regionBeanList&quot;:[],&quot;sortId&quot;:13&#125;,&#123;&quot;fullLabel&quot;:&quot;辽宁省-三级数据&quot;,&quot;id&quot;:562,&quot;label&quot;:&quot;三级数据&quot;,&quot;parentId&quot;:560,&quot;regionBeanList&quot;:[],&quot;sortId&quot;:13&#125;,&#123;&quot;fullLabel&quot;:&quot;辽宁省-三级数据&quot;,&quot;id&quot;:563,&quot;label&quot;:&quot;三级数据&quot;,&quot;parentId&quot;:560,&quot;regionBeanList&quot;:[],&quot;sortId&quot;:13&#125;,&#123;&quot;fullLabel&quot;:&quot;辽宁省-三级数据&quot;,&quot;id&quot;:564,&quot;label&quot;:&quot;三级数据&quot;,&quot;parentId&quot;:560,&quot;regionBeanList&quot;:[],&quot;sortId&quot;:13&#125;,&#123;&quot;fullLabel&quot;:&quot;辽宁省-三级数据&quot;,&quot;id&quot;:565,&quot;label&quot;:&quot;三级数据&quot;,&quot;parentId&quot;:560,&quot;regionBeanList&quot;:[],&quot;sortId&quot;:13&#125;,&#123;&quot;fullLabel&quot;:&quot;辽宁省-三级数据&quot;,&quot;id&quot;:566,&quot;label&quot;:&quot;三级数据&quot;,&quot;parentId&quot;:560,&quot;regionBeanList&quot;:[&#123;&quot;fullLabel&quot;:&quot;辽宁省-四级数据&quot;,&quot;id&quot;:666,&quot;label&quot;:&quot;四级数据&quot;,&quot;parentId&quot;:566,&quot;regionBeanList&quot;:[],&quot;sortId&quot;:13&#125;],&quot;sortId&quot;:13&#125;],&quot;sortId&quot;:13&#125;],&quot;sortId&quot;:8&#125;]</span><br><span class="line"></span><br></pre></td></tr></table></figure></p><p>我的博客即将同步至腾讯云+社区，邀请大家一同入驻：<a href="https://cloud.tencent.com/developer/support-plan?invite_code=1n712ep0u8906">https://cloud.tencent.com/developer/support-plan?invite_code=1n712ep0u8906</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;跟网上的不同的是，我这种方式是以时间换空间的做法，不会一次性把数据全查出来再慢慢遍历，而是每次查询是否存在子级，有就递归下去查。&lt;br&gt;数据量大时，查库的次数比较多，数据量少时对数据库查询次数少，压力较小，但是多次查询不会出现一次查询数据量很大卡住的情况。&lt;/p&gt;
&lt;h3 id=&quot;思路&quot;&gt;&lt;a href=&quot;#思路&quot; class=&quot;headerlink&quot; title=&quot;思路&quot;&gt;&lt;/a&gt;思路&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;先获取一级菜单，对每个一级菜单设子区域。&lt;/li&gt;
&lt;li&gt;如果子区域还有子区域，就递归查询，直到查不到子区域返回。&lt;/li&gt;
&lt;li&gt;递归的核心就是在方法中设置一个返回条件，防止无限递归下去。&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
      <category term="algorithm" scheme="http://liukay.com/categories/algorithm/"/>
    
    
      <category term="算法" scheme="http://liukay.com/tags/%E7%AE%97%E6%B3%95/"/>
    
      <category term="递归" scheme="http://liukay.com/tags/%E9%80%92%E5%BD%92/"/>
    
  </entry>
  
  <entry>
    <title>server和client模式的区别</title>
    <link href="http://liukay.com/2019/06/01/jvm-server%E5%92%8Cclient%E6%A8%A1%E5%BC%8F/"/>
    <id>http://liukay.com/2019/06/01/jvm-server和client模式/</id>
    <published>2019-06-01T13:02:21.000Z</published>
    <updated>2020-12-15T04:09:18.992Z</updated>
    
    <content type="html"><![CDATA[<pre><code>这两个相反的，由jvm启动时自动选择。</code></pre><p>   <code>-server 模式</code>：初始空间大，默认启动并行 VM，启动慢，运行快<br>    <code>-client 模式</code>：初始空间小，默认启动串行 VM，启动快，运行慢<br>    一般情况下 -server 模式多<br><a id="more"></a></p><ol><li><p>64位系统只能使用 server 模式</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">java -version</span><br><span class="line">java version <span class="string">&quot;11.0.2&quot;</span> <span class="number">2019</span>-<span class="number">01</span>-<span class="number">15</span> LTS</span><br><span class="line">Java(TM) SE Runtime Environment <span class="number">18.9</span> (build <span class="number">11.0</span>.<span class="number">2</span>+<span class="number">9</span>-LTS)</span><br><span class="line"><span class="function">Java <span class="title">HotSpot</span><span class="params">(TM)</span> 64-Bit Server VM 18.9 <span class="params">(build <span class="number">11.0</span><span class="number">.2</span>+<span class="number">9</span>-LTS, mixed mode)</span></span></span><br></pre></td></tr></table></figure><p> 32位了解即可</p></li><li><p>测试 java -D 命令<br> -D 后面传入的命令，会解析成 System 中的属性</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//java -DtestJvm=test TestGetSystemProperties</span></span><br><span class="line">    String test = System.getProperty(<span class="string">&quot;testJvm&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">null</span> != test) &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;test -&gt;&quot;</span> + test);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;property is null&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3.启动选择模式<br><code>java -client -showversion TestGetSystemProperties</code></p></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;pre&gt;&lt;code&gt;这两个相反的，由jvm启动时自动选择。
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;   &lt;code&gt;-server 模式&lt;/code&gt;：初始空间大，默认启动并行 VM，启动慢，运行快&lt;br&gt;    &lt;code&gt;-client 模式&lt;/code&gt;：初始空间小，默认启动串行 VM，启动快，运行慢&lt;br&gt;    一般情况下 -server 模式多&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="java" scheme="http://liukay.com/categories/java/"/>
    
      <category term="jvm" scheme="http://liukay.com/categories/java/jvm/"/>
    
    
      <category term="jvm" scheme="http://liukay.com/tags/jvm/"/>
    
      <category term="client 模式" scheme="http://liukay.com/tags/client-%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="server 模式" scheme="http://liukay.com/tags/server-%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>spring cloud eureka 注册服务显示IP端口号</title>
    <link href="http://liukay.com/2019/05/06/springcloud--%E6%9C%8D%E5%8A%A1%E6%98%BE%E7%A4%BAIP%E7%AB%AF%E5%8F%A3%E5%8F%B7/"/>
    <id>http://liukay.com/2019/05/06/springcloud--服务显示IP端口号/</id>
    <published>2019-05-06T06:21:29.000Z</published>
    <updated>2020-12-15T04:09:18.996Z</updated>
    
    <content type="html"><![CDATA[<p>Spring cloud 显示 INSTANCE-ID 如果以IP + 端口号的形式显示，会更清析的定位每个服务所在的机器节点的状态。</p><h3 id="依赖的-pom"><a href="#依赖的-pom" class="headerlink" title="依赖的 pom"></a>依赖的 pom</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-commons<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.0.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><a id="more"></a><h3 id="yml-相关配置"><a href="#yml-相关配置" class="headerlink" title="yml 相关配置"></a>yml 相关配置</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://10.168.16.101:8761/eureka/</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">instance-id:</span> <span class="string">$&#123;spring.cloud.client.ip-address&#125;:$&#123;spring.application.instance_id:$&#123;server.port&#125;&#125;</span></span><br><span class="line">    <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h3><p><img src="/2019/05/06/springcloud--%E6%9C%8D%E5%8A%A1%E6%98%BE%E7%A4%BAIP%E7%AB%AF%E5%8F%A3%E5%8F%B7/1557126376514.jpg" alt="效果图"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Spring cloud 显示 INSTANCE-ID 如果以IP + 端口号的形式显示，会更清析的定位每个服务所在的机器节点的状态。&lt;/p&gt;
&lt;h3 id=&quot;依赖的-pom&quot;&gt;&lt;a href=&quot;#依赖的-pom&quot; class=&quot;headerlink&quot; title=&quot;依赖的 pom&quot;&gt;&lt;/a&gt;依赖的 pom&lt;/h3&gt;&lt;figure class=&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.springframework.cloud&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;spring-cloud-commons&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;2.1.0.RELEASE&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="java" scheme="http://liukay.com/categories/java/"/>
    
      <category term="spring cloud" scheme="http://liukay.com/categories/java/spring-cloud/"/>
    
    
      <category term="spring cloud" scheme="http://liukay.com/tags/spring-cloud/"/>
    
      <category term="java" scheme="http://liukay.com/tags/java/"/>
    
      <category term="eureka" scheme="http://liukay.com/tags/eureka/"/>
    
  </entry>
  
  <entry>
    <title>spring cloud 四种服务下线方式</title>
    <link href="http://liukay.com/2019/05/05/springcloud--%E5%9B%9B%E7%A7%8D%E6%9C%8D%E5%8A%A1%E4%B8%8B%E7%BA%BF%E6%96%B9%E5%BC%8F/"/>
    <id>http://liukay.com/2019/05/05/springcloud--四种服务下线方式/</id>
    <published>2019-05-05T12:06:54.000Z</published>
    <updated>2020-12-15T04:09:18.996Z</updated>
    
    <content type="html"><![CDATA[<p>这里指已经在 Eureka 注册中心注册的服务，如果需要停用，有四种方式进行停用。</p><h3 id="1-直接关闭"><a href="#1-直接关闭" class="headerlink" title="1.直接关闭"></a>1.直接关闭</h3><p>最粗暴。<br>写这个是因为，直接关闭，如果 Eureka 开了保护模式，会导至服务已关闭，但是未下线，还是会重试调用。如果不需强稳定性的话可以这么干。</p><h3 id="2-客户端主动通知注册中心下线"><a href="#2-客户端主动通知注册中心下线" class="headerlink" title="2.客户端主动通知注册中心下线"></a>2.客户端主动通知注册中心下线</h3><p>安全。<br>Eureka注册中心在收到某个客户端下线后不会马上通知所有的注册的客户端，而是等到客户端进行心跳的时候(心跳(续约)频率，默认30秒 )再将下的数据返回。通过这种方式下线的话，可以在某个服务下线后防止其他服务调用此服务失败。</p><p>白话就是，服务状态下线了，但是不通知其他服务。等到续约时间到了，再通知所有注册服务。</p><a id="more"></a><p>猜测，服务下线后，在没有心跳前，其他服务还是可以进行调用。等到心跳后，通知所有服务已下线，其他服务认为已下线，就不会再调该下线服务。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   <span class="keyword">private</span> DiscoveryClient client;</span><br><span class="line">   <span class="meta">@ResponseBody</span></span><br><span class="line">   <span class="meta">@GetMapping(&quot;/eurekaUnRegister&quot;)</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">shutDown</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       eurekaClient.shutdown();</span><br><span class="line">       <span class="keyword">return</span> <span class="string">&quot;eurekaUnRegistering&quot;</span>;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><br>或<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/offline&quot;, method = RequestMethod.GET)</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">offLine</span><span class="params">()</span></span>&#123;</span><br><span class="line">   DiscoveryManager.getInstance().shutdownComponent();</span><br><span class="line"> &#125;  </span><br></pre></td></tr></table></figure></p><h3 id="3-调用接口方式下线"><a href="#3-调用接口方式下线" class="headerlink" title="3.调用接口方式下线"></a>3.调用接口方式下线</h3><p><a href="http://10.168.62.58:9999/message/actuator/shutdown">http://10.168.62.58:9999/message/actuator/shutdown</a></p><p>返回结果<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="attr">&quot;message&quot;</span>: <span class="string">&quot;Shutting down, bye...&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>本地起机器后，调试结果</p><p>结果就是服务线程关闭，服务停止：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Stopping beans in phase 2147483647</span><br><span class="line">Stopping beans in phase 0</span><br><span class="line">Unregistering JMX-exposed beans on shutdown</span><br><span class="line">DiscoveryClient_GROUP-MESSAGE&#x2F;group-message-provider-704 - registration status: 204</span><br><span class="line">Shutting down DiscoveryClient ...</span><br><span class="line">Unregistering ...</span><br><span class="line">DiscoveryClient_GROUP-MESSAGE&#x2F;group-message-provider-704 - deregister  status: 200</span><br></pre></td></tr></table></figure><br>网上博客<a href="https://blog.csdn.net/memmsc/article/details/78122962">https://blog.csdn.net/memmsc/article/details/78122962</a></p><h3 id="4-修改服务状态"><a href="#4-修改服务状态" class="headerlink" title="4.修改服务状态"></a>4.修改服务状态</h3><p>这种方式，服务不会停止，只是状态变为 DOWN，适合禁用该服务的操作。<br>DOWN 禁用<br>UP 启用<br><a href="http://10.168.62.58:9999/message/actuator/service-registry">http://10.168.62.58:9999/message/actuator/service-registry</a><br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">       <span class="attr">&quot;status&quot;</span>: <span class="string">&quot;UP&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>sprinng boot 2.0 以上需要添加额外配置才能生效，否则报404<br><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management:</span></span><br><span class="line"> <span class="attr">endpoints:</span></span><br><span class="line">   <span class="attr">web:</span></span><br><span class="line">     <span class="attr">exposure:</span></span><br><span class="line">       <span class="attr">include:</span> <span class="string">&quot;*&quot;</span>                <span class="comment">#包含的路径，可以单个如 info</span></span><br><span class="line"> <span class="attr">endpoint:</span></span><br><span class="line">   <span class="attr">shutdown:</span></span><br><span class="line">     <span class="attr">enabled:</span> <span class="literal">true</span>                <span class="comment">#开启shutdown 关闭</span></span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;这里指已经在 Eureka 注册中心注册的服务，如果需要停用，有四种方式进行停用。&lt;/p&gt;
&lt;h3 id=&quot;1-直接关闭&quot;&gt;&lt;a href=&quot;#1-直接关闭&quot; class=&quot;headerlink&quot; title=&quot;1.直接关闭&quot;&gt;&lt;/a&gt;1.直接关闭&lt;/h3&gt;&lt;p&gt;最粗暴。&lt;br&gt;写这个是因为，直接关闭，如果 Eureka 开了保护模式，会导至服务已关闭，但是未下线，还是会重试调用。如果不需强稳定性的话可以这么干。&lt;/p&gt;
&lt;h3 id=&quot;2-客户端主动通知注册中心下线&quot;&gt;&lt;a href=&quot;#2-客户端主动通知注册中心下线&quot; class=&quot;headerlink&quot; title=&quot;2.客户端主动通知注册中心下线&quot;&gt;&lt;/a&gt;2.客户端主动通知注册中心下线&lt;/h3&gt;&lt;p&gt;安全。&lt;br&gt;Eureka注册中心在收到某个客户端下线后不会马上通知所有的注册的客户端，而是等到客户端进行心跳的时候(心跳(续约)频率，默认30秒 )再将下的数据返回。通过这种方式下线的话，可以在某个服务下线后防止其他服务调用此服务失败。&lt;/p&gt;
&lt;p&gt;白话就是，服务状态下线了，但是不通知其他服务。等到续约时间到了，再通知所有注册服务。&lt;/p&gt;
    
    </summary>
    
      <category term="java" scheme="http://liukay.com/categories/java/"/>
    
      <category term="spring cloud" scheme="http://liukay.com/categories/java/spring-cloud/"/>
    
    
      <category term="spring cloud" scheme="http://liukay.com/tags/spring-cloud/"/>
    
      <category term="java" scheme="http://liukay.com/tags/java/"/>
    
      <category term="服务下线" scheme="http://liukay.com/tags/%E6%9C%8D%E5%8A%A1%E4%B8%8B%E7%BA%BF/"/>
    
  </entry>
  
  <entry>
    <title>JVM 详细日志输出解释--[-XX:+PrintGCDetails]</title>
    <link href="http://liukay.com/2019/04/25/jvm-%E8%AF%A6%E7%BB%86%E6%97%A5%E5%BF%97%E8%BE%93%E5%87%BA/"/>
    <id>http://liukay.com/2019/04/25/jvm-详细日志输出/</id>
    <published>2019-04-25T03:25:13.000Z</published>
    <updated>2021-04-25T04:32:01.646Z</updated>
    
    <content type="html"><![CDATA[<pre><code>这个用来理解每个日志的意义。1.Allocation Failure 分配 失败2.promotion Failure:       晋升 失败，进行Minor GC时，survivor space放不下, 对象只能放入老年代，而此时老年代也放不下造成的；3.concurrent mode failure：是在执行CMS GC的过程中同时有对象要放入老年代，而此时老年代空间不足造成的</code></pre><h3 id="1-GC日志想说的是："><a href="#1-GC日志想说的是：" class="headerlink" title="1.GC日志想说的是："></a>1.GC日志想说的是：</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">0.098:</span> [<span class="string">GC</span> <span class="string">(Allocation</span> <span class="string">Failure)</span> [<span class="attr">PSYoungGen:</span> <span class="string">1022K-&gt;490K(1536K)</span>] <span class="string">1022K-&gt;522K(30208K)</span>, <span class="number">0.0007804</span> <span class="string">secs</span>] [<span class="attr">Times:</span> <span class="string">user=0.00</span> <span class="string">sys=0.00</span>, <span class="string">real=0.00</span> <span class="string">secs</span>]</span><br><span class="line"><span class="attr">1.959:</span> [<span class="string">Full</span> <span class="string">GC</span> <span class="string">(Ergonomics)</span> [<span class="attr">PSYoungGen:</span> <span class="string">384K-&gt;0K(1536K)</span>] [<span class="attr">ParOldGen:</span> <span class="string">28064K-&gt;11941K(28672K)</span>] <span class="string">28448K-&gt;11941K(30208K)</span>, [<span class="attr">Metaspace:</span> <span class="string">3382K-&gt;3382K(1056768K)</span>], <span class="number">0.0063741</span> <span class="string">secs</span>] [<span class="attr">Times:</span> <span class="string">user=0.02</span> <span class="string">sys=0.00</span>, <span class="string">real=0.01</span> <span class="string">secs</span>]</span><br></pre></td></tr></table></figure><p><strong>日志说明</strong></p><blockquote><p>0.098: 运行时间<br>GC (Allocation Failure): [GC类型 (原因)]<br>[PSYoungGen: 1022K-&gt;490K(1536K)]: [收集器类型: GC前该内存区域已经使用容量-&gt;GC后该内存区域已使用容量(该内存区域总容量)],执行时间 secs<br>[Times: user=0.00 sys=0.00, real=0.00 secs]: user=用户线程使用时间 sys=系统执行使用时间, real=真正回收时间</p></blockquote><p><strong>连起来看</strong><br>运行时间: [GC类型 (原因)] [收集器类型: GC前该内存区域已经使用容量-&gt;GC后该内存区域已使用容量(该内存区域总容量)] GC前Java堆已使用容量-&gt;GC后Java堆已使用容量（Java堆总容量）, 执行时间 secs] [Times: user=0.00 sys=0.00, real=0.00 secs]</p><h3 id="2-jvm-执持时间"><a href="#2-jvm-执持时间" class="headerlink" title="2.jvm 执持时间"></a>2.jvm 执持时间</h3><p>0.098、0.143 都是 jvm 启动后的时间，从 0 开始</p><h3 id="3-GC-和-Full-GC-回收类型"><a href="#3-GC-和-Full-GC-回收类型" class="headerlink" title="3.GC 和 Full (GC 回收类型)"></a>3.GC 和 Full (GC 回收类型)</h3><p>以 GC 和 Full GC 开头的说明了这次回收的停顿为型。<br>而不是用来区分新生代GC还是老年代GC的。<br>如果有”Full GC”，说明这次GC是发生了Stop-The-World的。<br><a id="more"></a></p><h3 id="4-PSYoungGen、-ParOldGen、-Metaspace表示GC发生的区域。"><a href="#4-PSYoungGen、-ParOldGen、-Metaspace表示GC发生的区域。" class="headerlink" title="4.[PSYoungGen、[ParOldGen、[Metaspace表示GC发生的区域。"></a>4.[PSYoungGen、[ParOldGen、[Metaspace表示GC发生的区域。</h3><p>这里显示的区域名称与使用的GC收集器是密切相关的，<br>例如上面的PSYoungGen表示采用Parallel Scavenge收集器，<br>ParOldGen表示采用Parallel Old收集器。<br>如果使用Serial收集器显示[DefNew，如果使用ParNew收集器显示[ParNew。</p><h3 id="5-括号中的含义"><a href="#5-括号中的含义" class="headerlink" title="5.括号中的含义"></a>5.括号中的含义</h3><p>5.1后面方括号内部的1022K-&gt;490K(1536K)含义是:<br>“GC前该内存区域已经使用容量-&gt;GC后该内存区域已使用容量（该内存区域总容量）”。<br>而在方括号之外的1022K-&gt;522K(30208K)表示：<br>“GC前Java堆已使用容量-&gt;GC后Java堆已使用容量（Java堆总容量）”。<br>再往后的 0.0007804 secs 表示该内存区域GC所占用的时间，单位是秒。<br>[Times: user=0.00 sys=0.00, real=0.00 secs]<br>表示:<br>user、sys、real 与 Linux 的 time 命令所输出的时间含义一致，分别代表用户态消耗的CPU时间、内核态消耗的CPU时间 和 操作从开始到结束所经过的墙钟时间（Wall Clock Time）。<br>CPU时间与墙钟时间的区别是，墙钟时间包括各种非运算的等待耗时，例如等待磁盘IO、等待线程阻塞，而CPU时间不包括这些耗时，但当系统有多CPU或者多核的话，多线程操作会叠加这些CPU时间，所以读者看到 user 或 sys 时间超过 real 时间是完全正常的。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">0.098:</span> [<span class="string">GC</span> <span class="string">(Allocation</span> <span class="string">Failure)</span> [<span class="attr">PSYoungGen:</span> <span class="string">1022K-&gt;490K(1536K)</span>] <span class="string">1022K-&gt;522K(30208K)</span>, <span class="number">0.0007804</span> <span class="string">secs</span>] [<span class="attr">Times:</span> <span class="string">user=0.00</span> <span class="string">sys=0.00</span>, <span class="string">real=0.00</span> <span class="string">secs</span>]</span><br><span class="line"><span class="attr">0.143:</span> [<span class="string">GC</span> <span class="string">(Allocation</span> <span class="string">Failure)</span> [<span class="attr">PSYoungGen:</span> <span class="string">1514K-&gt;490K(1536K)</span>] <span class="string">1546K-&gt;797K(30208K)</span>, <span class="number">0.0014763</span> <span class="string">secs</span>] [<span class="attr">Times:</span> <span class="string">user=0.00</span> <span class="string">sys=0.00</span>, <span class="string">real=0.00</span> <span class="string">secs</span>]</span><br><span class="line"><span class="attr">0.154:</span> [<span class="string">GC</span> <span class="string">(Allocation</span> <span class="string">Failure)</span> [<span class="attr">PSYoungGen:</span> <span class="string">1466K-&gt;490K(1536K)</span>] <span class="string">1773K-&gt;1064K(30208K)</span>, <span class="number">0.0021920</span> <span class="string">secs</span>] [<span class="attr">Times:</span> <span class="string">user=0.00</span> <span class="string">sys=0.00</span>, <span class="string">real=0.00</span> <span class="string">secs</span>]</span><br><span class="line"><span class="attr">0.179:</span> [<span class="string">GC</span> <span class="string">(Allocation</span> <span class="string">Failure)</span> [<span class="attr">PSYoungGen:</span> <span class="string">1514K-&gt;490K(1536K)</span>] <span class="string">2088K-&gt;1224K(30208K)</span>, <span class="number">0.0014370</span> <span class="string">secs</span>] [<span class="attr">Times:</span> <span class="string">user=0.00</span> <span class="string">sys=0.00</span>, <span class="string">real=0.00</span> <span class="string">secs</span>]</span><br><span class="line"><span class="attr">0.212:</span> [<span class="string">GC</span> <span class="string">(Allocation</span> <span class="string">Failure)</span> [<span class="attr">PSYoungGen:</span> <span class="string">1514K-&gt;490K(1536K)</span>] <span class="string">2248K-&gt;1534K(30208K)</span>, <span class="number">0.0013529</span> <span class="string">secs</span>] [<span class="attr">Times:</span> <span class="string">user=0.01</span> <span class="string">sys=0.00</span>, <span class="string">real=0.00</span> <span class="string">secs</span>]</span><br><span class="line"><span class="attr">0.257:</span> [<span class="string">GC</span> <span class="string">(Allocation</span> <span class="string">Failure)</span> [<span class="attr">PSYoungGen:</span> <span class="string">1513K-&gt;490K(1536K)</span>] <span class="string">2556K-&gt;1664K(30208K)</span>, <span class="number">0.0082179</span> <span class="string">secs</span>] [<span class="attr">Times:</span> <span class="string">user=0.00</span> <span class="string">sys=0.00</span>, <span class="string">real=0.01</span> <span class="string">secs</span>]</span><br><span class="line"><span class="attr">1.957:</span> [<span class="string">GC</span> <span class="string">(Allocation</span> <span class="string">Failure)</span> [<span class="attr">PSYoungGen:</span> <span class="string">769K-&gt;384K(1536K)</span>] <span class="string">28567K-&gt;28448K(30208K)</span>, <span class="number">0.0016967</span> <span class="string">secs</span>] [<span class="attr">Times:</span> <span class="string">user=0.00</span> <span class="string">sys=0.00</span>, <span class="string">real=0.00</span> <span class="string">secs</span>]</span><br><span class="line"><span class="attr">1.959:</span> [<span class="string">Full</span> <span class="string">GC</span> <span class="string">(Ergonomics)</span> [<span class="attr">PSYoungGen:</span> <span class="string">384K-&gt;0K(1536K)</span>] [<span class="attr">ParOldGen:</span> <span class="string">28064K-&gt;11941K(28672K)</span>] <span class="string">28448K-&gt;11941K(30208K)</span>, [<span class="attr">Metaspace:</span> <span class="string">3382K-&gt;3382K(1056768K)</span>], <span class="number">0.0063741</span> <span class="string">secs</span>] [<span class="attr">Times:</span> <span class="string">user=0.02</span> <span class="string">sys=0.00</span>, <span class="string">real=0.01</span> <span class="string">secs</span>]</span><br><span class="line"><span class="attr">3.621:</span> [<span class="string">GC</span> <span class="string">(Allocation</span> <span class="string">Failure)</span> [<span class="attr">PSYoungGen:</span> <span class="string">20K-&gt;32K(1536K)</span>] <span class="string">28346K-&gt;28357K(30208K)</span>, <span class="number">0.0012428</span> <span class="string">secs</span>] [<span class="attr">Times:</span> <span class="string">user=0.00</span> <span class="string">sys=0.00</span>, <span class="string">real=0.01</span> <span class="string">secs</span>]</span><br><span class="line"><span class="attr">3.622:</span> [<span class="string">Full</span> <span class="string">GC</span> <span class="string">(Ergonomics)</span> [<span class="attr">PSYoungGen:</span> <span class="string">32K-&gt;0K(1536K)</span>] [<span class="attr">ParOldGen:</span> <span class="string">28325K-&gt;11936K(28672K)</span>] <span class="string">28357K-&gt;11936K(30208K)</span>, [<span class="attr">Metaspace:</span> <span class="string">3386K-&gt;3386K(1056768K)</span>], <span class="number">0.0038742</span> <span class="string">secs</span>] [<span class="attr">Times:</span> <span class="string">user=0.01</span> <span class="string">sys=0.00</span>, <span class="string">real=0.00</span> <span class="string">secs</span>]</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;pre&gt;&lt;code&gt;这个用来理解每个日志的意义。

1.Allocation Failure 分配 失败
2.promotion Failure: 
      晋升 失败，进行Minor GC时，survivor space放不下, 对象只能放入老年代，而此时老年代也放不下造成的；
3.concurrent mode failure：是在执行CMS GC的过程中同时有对象要放入老年代，而此时老年代空间不足造成的
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&quot;1-GC日志想说的是：&quot;&gt;&lt;a href=&quot;#1-GC日志想说的是：&quot; class=&quot;headerlink&quot; title=&quot;1.GC日志想说的是：&quot;&gt;&lt;/a&gt;1.GC日志想说的是：&lt;/h3&gt;&lt;figure class=&quot;highlight yml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;0.098:&lt;/span&gt; [&lt;span class=&quot;string&quot;&gt;GC&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;(Allocation&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;Failure)&lt;/span&gt; [&lt;span class=&quot;attr&quot;&gt;PSYoungGen:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;1022K-&amp;gt;490K(1536K)&lt;/span&gt;] &lt;span class=&quot;string&quot;&gt;1022K-&amp;gt;522K(30208K)&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0.0007804&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;secs&lt;/span&gt;] [&lt;span class=&quot;attr&quot;&gt;Times:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;user=0.00&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;sys=0.00&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;real=0.00&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;secs&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;1.959:&lt;/span&gt; [&lt;span class=&quot;string&quot;&gt;Full&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;GC&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;(Ergonomics)&lt;/span&gt; [&lt;span class=&quot;attr&quot;&gt;PSYoungGen:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;384K-&amp;gt;0K(1536K)&lt;/span&gt;] [&lt;span class=&quot;attr&quot;&gt;ParOldGen:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;28064K-&amp;gt;11941K(28672K)&lt;/span&gt;] &lt;span class=&quot;string&quot;&gt;28448K-&amp;gt;11941K(30208K)&lt;/span&gt;, [&lt;span class=&quot;attr&quot;&gt;Metaspace:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;3382K-&amp;gt;3382K(1056768K)&lt;/span&gt;], &lt;span class=&quot;number&quot;&gt;0.0063741&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;secs&lt;/span&gt;] [&lt;span class=&quot;attr&quot;&gt;Times:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;user=0.02&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;sys=0.00&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;real=0.01&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;secs&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;日志说明&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;0.098: 运行时间&lt;br&gt;GC (Allocation Failure): [GC类型 (原因)]&lt;br&gt;[PSYoungGen: 1022K-&amp;gt;490K(1536K)]: [收集器类型: GC前该内存区域已经使用容量-&amp;gt;GC后该内存区域已使用容量(该内存区域总容量)],执行时间 secs&lt;br&gt;[Times: user=0.00 sys=0.00, real=0.00 secs]: user=用户线程使用时间 sys=系统执行使用时间, real=真正回收时间&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;连起来看&lt;/strong&gt;&lt;br&gt;运行时间: [GC类型 (原因)] [收集器类型: GC前该内存区域已经使用容量-&amp;gt;GC后该内存区域已使用容量(该内存区域总容量)] GC前Java堆已使用容量-&amp;gt;GC后Java堆已使用容量（Java堆总容量）, 执行时间 secs] [Times: user=0.00 sys=0.00, real=0.00 secs]&lt;/p&gt;
&lt;h3 id=&quot;2-jvm-执持时间&quot;&gt;&lt;a href=&quot;#2-jvm-执持时间&quot; class=&quot;headerlink&quot; title=&quot;2.jvm 执持时间&quot;&gt;&lt;/a&gt;2.jvm 执持时间&lt;/h3&gt;&lt;p&gt;0.098、0.143 都是 jvm 启动后的时间，从 0 开始&lt;/p&gt;
&lt;h3 id=&quot;3-GC-和-Full-GC-回收类型&quot;&gt;&lt;a href=&quot;#3-GC-和-Full-GC-回收类型&quot; class=&quot;headerlink&quot; title=&quot;3.GC 和 Full (GC 回收类型)&quot;&gt;&lt;/a&gt;3.GC 和 Full (GC 回收类型)&lt;/h3&gt;&lt;p&gt;以 GC 和 Full GC 开头的说明了这次回收的停顿为型。&lt;br&gt;而不是用来区分新生代GC还是老年代GC的。&lt;br&gt;如果有”Full GC”，说明这次GC是发生了Stop-The-World的。&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="java" scheme="http://liukay.com/categories/java/"/>
    
      <category term="jvm" scheme="http://liukay.com/categories/java/jvm/"/>
    
    
      <category term="jvm" scheme="http://liukay.com/tags/jvm/"/>
    
      <category term="日志" scheme="http://liukay.com/tags/%E6%97%A5%E5%BF%97/"/>
    
      <category term="说明" scheme="http://liukay.com/tags/%E8%AF%B4%E6%98%8E/"/>
    
  </entry>
  
  <entry>
    <title>产生线程死锁的原因和处理方式</title>
    <link href="http://liukay.com/2019/04/20/java-%E4%BA%A7%E7%94%9F%E7%BA%BF%E7%A8%8B%E6%AD%BB%E9%94%81%E7%9A%84%E5%8E%9F%E5%9B%A0%E5%92%8C%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F/"/>
    <id>http://liukay.com/2019/04/20/java-产生线程死锁的原因和处理方式/</id>
    <published>2019-04-20T13:14:38.000Z</published>
    <updated>2020-12-15T04:09:18.988Z</updated>
    
    <content type="html"><![CDATA[<h2 id="产生背景"><a href="#产生背景" class="headerlink" title="产生背景"></a>产生背景</h2><p>线程同步(就是加锁)会有一个问题，就是产生死锁</p><h2 id="所谓死锁"><a href="#所谓死锁" class="headerlink" title="所谓死锁"></a>所谓死锁</h2><p>是指两个或两个以上的进程在执行过程中，因争夺资源而造成的一种互相等待的现象，若无外力作用，它们都将无法推进下去。<br>发生死锁的具体原因如下:</p><a id="more"></a><ol><li>因为系统资源不足。</li><li>进程运行推进的顺序不合适。    </li><li>资源分配不当。</li></ol><h2 id="举列说明场景"><a href="#举列说明场景" class="headerlink" title="举列说明场景:"></a>举列说明场景:</h2><p>死锁是因为多线程访问共享资源，由于访问的顺序不当所造成的，通常是一个线程锁定了一个资源A，而又想去锁定资源B；在另一个线程中，锁定了资源B，而又想去锁定资源A以完成自身的操作，两个线程都想得到对方的资源，而不愿释放自己的资源，造成两个线程都在等待，而无法执行的情况。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">背景: 线程同步(就是加锁)会有一个问题，就是产生死锁</span><br><span class="line">所谓死锁: 是指两个或两个以上的进程在执行过程中，因争夺资源而造成的一种互相等待的现象，若无外力作用，它们都将无法推进下去。</span><br><span class="line">帮助理解：</span><br><span class="line">地上放着两个桶泡面，一个老坛酸菜，一个小鸡炖磨茹。两个人一个产品，一个测试，同时出发去抢老坛酸菜和小鸡炖磨茹，产品老坛酸菜，测试拿到小鸡炖磨茹，同一时刻，产品伸要去拽测试怀里的小鸡炖磨茹，测试伸手去拽产品的老坛酸菜，两个僵持不下，就死在那了，叫死锁。如果没有开发将他们各打一顿解救出来，它们奖无法推进下去。</span><br><span class="line">发生死锁的具体原因如下:</span><br><span class="line">1. 因为系统资源不足。</span><br><span class="line">2. 进程运行推进的顺序不合适。    </span><br><span class="line">3. 资源分配不当。</span><br><span class="line">举列说明场景:</span><br><span class="line">死锁是因为多线程访问共享资源，由于访问的顺序不当所造成的，通常是一个线程锁定了一个资源A，而又想去锁定资源B；在另一个线程中，锁定了资源B，而又想去锁定资源A以完成自身的操作，两个线程都想得到对方的资源，而不愿释放自己的资源，造成两个线程都在等待，而无法执行的情况。</span><br><span class="line">死锁预防</span><br><span class="line">如果只使用一个锁就不会有死锁的问题，不过复杂场景下不太理实。</span><br><span class="line">1.以确定的顺序获得锁</span><br><span class="line">    线程A ---&gt; 锁定 A  ----&gt; 偿试锁定 B</span><br><span class="line">    线程B ---&gt; 锁定 A  ----&gt; 偿试锁定 B</span><br><span class="line">    这样就不会发生死锁</span><br><span class="line">2.超时放弃</span><br><span class="line">Lock接口提供了boolean tryLock(long time, TimeUnit unit) throws InterruptedException方法，该方法可以按照固定时长等待锁，因此线程可以在获取锁超时以后，主动释放之前已经获得的所有的锁。通过这种方式，也可以很有效地避免死锁。</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;产生背景&quot;&gt;&lt;a href=&quot;#产生背景&quot; class=&quot;headerlink&quot; title=&quot;产生背景&quot;&gt;&lt;/a&gt;产生背景&lt;/h2&gt;&lt;p&gt;线程同步(就是加锁)会有一个问题，就是产生死锁&lt;/p&gt;
&lt;h2 id=&quot;所谓死锁&quot;&gt;&lt;a href=&quot;#所谓死锁&quot; class=&quot;headerlink&quot; title=&quot;所谓死锁&quot;&gt;&lt;/a&gt;所谓死锁&lt;/h2&gt;&lt;p&gt;是指两个或两个以上的进程在执行过程中，因争夺资源而造成的一种互相等待的现象，若无外力作用，它们都将无法推进下去。&lt;br&gt;发生死锁的具体原因如下:&lt;/p&gt;
    
    </summary>
    
      <category term="java" scheme="http://liukay.com/categories/java/"/>
    
      <category term="concurrent" scheme="http://liukay.com/categories/java/concurrent/"/>
    
    
      <category term="多线程" scheme="http://liukay.com/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
      <category term="死锁" scheme="http://liukay.com/tags/%E6%AD%BB%E9%94%81/"/>
    
      <category term="并发" scheme="http://liukay.com/tags/%E5%B9%B6%E5%8F%91/"/>
    
  </entry>
  
</feed>
